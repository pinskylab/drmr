<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Examples • drmr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="examples_files/libs/quarto-html/popper.min.js"></script><script src="examples_files/libs/quarto-html/tippy.umd.min.js"></script><link href="examples_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="examples_files/libs/quarto-html/light-border.css" rel="stylesheet">
<!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Examples">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">drmr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/examples.html">Examples</a></li>
    <li><a class="dropdown-item" href="../articles/get-started.html">Get Started</a></li>
    <li><a class="dropdown-item" href="../articles/theory.html">Theoretical Background</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/pinskylab/drmr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-quarto">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Examples</h1>

      <p class="author">Lucas da Cunha Godoy</p>


      <small class="dont-index">Source: <a href="https://github.com/pinskylab/drmr/blob/main/vignettes/examples.qmd" class="external-link"><code>vignettes/examples.qmd</code></a></small>
      <div class="d-none name"><code></code></div>
    </div>






    <hr>
<section class="level2 unnumbered"><h2 class="unnumbered" id="tl-dr">TL; DR<a class="anchor" aria-label="anchor" href="#tl-dr"></a>
</h2>
<p>This document demonstrates the functionalities of the <code>drmr</code> R package for fitting Dynamic Range and Species Distribution Models (DRMs and SDMs, respectively) using pre-compiled <code>Stan</code> models.</p>
<p>We’ll explore increasingly complex models, showcasing the package’s capabilities with the help of five additional <code>R</code> packages:</p>
<ul>
<li>
<code>sf</code>: for spatial data manipulation and visualization</li>
<li>
<code>ggplot2</code>: for creating graphs</li>
<li>
<code>bayesplot</code>: for visualizing MCMC outputs</li>
<li>
<code>dplyr</code>: for data wrangling</li>
</ul></section><section class="level2"><h2 id="sec-drmr">Installing the <code>drmr</code> package<a class="anchor" aria-label="anchor" href="#sec-drmr"></a>
</h2>
<p>The <code>drmr</code> package provides pre-compiled <code>cmdstanr</code> <span class="citation" data-cites="gabry2024cmdstanr">(<a href="#ref-gabry2024cmdstanr" role="doc-biblioref">Gabry et al. 2024</a>)</span> models powered by the <code>instantiate</code> package <span class="citation" data-cites="landau2024instantiate">(<a href="#ref-landau2024instantiate" role="doc-biblioref">Landau 2024</a>)</span>. These pre-compiled models allow us to make inferences about the DRM (and SDM) using <code>cmdstan</code> algorithms, such as the HMC NUTS Sampler.</p>
<p>The package is not on CRAN yet. To install the version hosted on GitHub, run:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"pinskylab/drmr"</span><span class="op">)</span></span></code></pre></div>
</div>
<p>Finally, the code below loads the packages necessary to reproduce the examples in this document.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://pinskylab.github.io/drmr/">drmr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span> <span class="co">## "mapping"</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Linking to GEOS 3.12.1, GDAL 3.8.4, PROJ 9.4.0; sf_use_s2() is TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span> <span class="co">## graphs</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mc-stan.org/bayesplot/" class="external-link">bayesplot</a></span><span class="op">)</span> <span class="co">## and more graphs</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>This is bayesplot version 1.12.0</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>- Online documentation and vignettes at mc-stan.org/bayesplot</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>- bayesplot theme set to bayesplot::theme_default()</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>   * Does _not_ affect other ggplot2 plots</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>   * See ?bayesplot_theme_set for details on theme setting</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:drmr':

    between</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
</div>
</section><section class="level2"><h2 id="sec-data">Data<a class="anchor" aria-label="anchor" href="#sec-data"></a>
</h2>
<p>For this example, we’ll use the package’s built-in <em>Summer flounder</em> dataset, which resembles the data analyzed in <span class="citation" data-cites="fredston2025dynamic">Fredston et al. (<a href="#ref-fredston2025dynamic" role="doc-biblioref">2025</a>)</span>. We load it by running:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## loads the data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">sum_fl</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## computing density</span></span>
<span><span class="va">sum_fl</span> <span class="op">&lt;-</span> <span class="va">sum_fl</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>dens <span class="op">=</span> <span class="fl">1000</span> <span class="op">*</span> <span class="va">y</span> <span class="op">/</span> <span class="va">area_km2</span>,</span>
<span>         .before <span class="op">=</span> <span class="va">y</span><span class="op">)</span></span></code></pre></div>
</div>
<p>A quick exploration of the data reveals the following:</p>
<ul>
<li><p>Surface salinity (ssalin) and bottom salinity (bsalin) have missing values (around 30% missing for each).</p></li>
<li><p>At least 25% of the density (<code>dens</code>) values are zero.</p></li>
</ul>
<p>Finally, we split the data, reserving the last five years for evaluating predictions:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## 5 years-ahead predictions</span></span>
<span><span class="va">first_year_forecast</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">sum_fl</span><span class="op">$</span><span class="va">year</span><span class="op">)</span> <span class="op">-</span> <span class="fl">5</span></span>
<span></span>
<span><span class="va">first_id_forecast</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">first_year_forecast</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">sum_fl</span><span class="op">$</span><span class="va">year</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span></span>
<span></span>
<span><span class="va">years_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">sum_fl</span><span class="op">$</span><span class="va">year</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">years_train</span> <span class="op">&lt;-</span> <span class="va">years_all</span><span class="op">[</span><span class="va">years_all</span> <span class="op">&lt;</span> <span class="va">first_id_forecast</span><span class="op">]</span></span>
<span><span class="va">years_test</span> <span class="op">&lt;-</span> <span class="va">years_all</span><span class="op">[</span><span class="va">years_all</span> <span class="op">&gt;=</span> <span class="va">first_id_forecast</span><span class="op">]</span></span>
<span></span>
<span><span class="co">## splitting data</span></span>
<span><span class="va">dat_test</span> <span class="op">&lt;-</span> <span class="va">sum_fl</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op">&gt;=</span> <span class="va">first_year_forecast</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat_train</span> <span class="op">&lt;-</span> <span class="va">sum_fl</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op">&lt;</span> <span class="va">first_year_forecast</span><span class="op">)</span></span></code></pre></div>
</div>
<p>When fitting models with explanatory variables, it’s good practice to standardize them by centering (subtracting the mean) and scaling (dividing by the standard deviation). This transformation to zero mean and unit variance offers two main benefits: it typically improves the efficiency of Monte Carlo Markov Chain (MCMC) sampling, and it makes comparing the magnitude of regression coefficients easier for assessing relative variable importance. For applications involving forecasting or prediction, it is crucial to calculate the mean and standard deviation for standardization using only the training dataset. These exact same values must then be applied to standardize the test dataset (or any future data), simulating the real-world scenario where information about future observations is unavailable during model fitting.</p>
<p>In that spirit, we center and scale some of our potential explanatory variables as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">avgs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"stemp"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dat_train</span><span class="op">$</span><span class="va">stemp</span><span class="op">)</span>,</span>
<span>          <span class="st">"btemp"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dat_train</span><span class="op">$</span><span class="va">btemp</span><span class="op">)</span>,</span>
<span>          <span class="st">"depth"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dat_train</span><span class="op">$</span><span class="va">depth</span><span class="op">)</span>,</span>
<span>          <span class="st">"n_hauls"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dat_train</span><span class="op">$</span><span class="va">n_hauls</span><span class="op">)</span>,</span>
<span>          <span class="st">"lat"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dat_train</span><span class="op">$</span><span class="va">lat</span><span class="op">)</span>,</span>
<span>          <span class="st">"lon"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dat_train</span><span class="op">$</span><span class="va">lon</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">min_year</span> <span class="op">&lt;-</span> <span class="va">dat_train</span><span class="op">$</span><span class="va">year</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## centering covariates</span></span>
<span><span class="va">dat_train</span> <span class="op">&lt;-</span> <span class="va">dat_train</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>c_stemp <span class="op">=</span> <span class="va">stemp</span> <span class="op">-</span> <span class="va">avgs</span><span class="op">[</span><span class="st">"stemp"</span><span class="op">]</span>,</span>
<span>         c_btemp <span class="op">=</span> <span class="va">btemp</span> <span class="op">-</span> <span class="va">avgs</span><span class="op">[</span><span class="st">"btemp"</span><span class="op">]</span>,</span>
<span>         c_hauls <span class="op">=</span> <span class="va">n_hauls</span> <span class="op">-</span> <span class="va">avgs</span><span class="op">[</span><span class="st">"n_hauls"</span><span class="op">]</span>,</span>
<span>         c_lat   <span class="op">=</span> <span class="va">lat</span> <span class="op">-</span> <span class="va">avgs</span><span class="op">[</span><span class="st">"lat"</span><span class="op">]</span>,</span>
<span>         c_lon   <span class="op">=</span> <span class="va">lon</span> <span class="op">-</span> <span class="va">avgs</span><span class="op">[</span><span class="st">"lon"</span><span class="op">]</span>,</span>
<span>         time  <span class="op">=</span> <span class="va">year</span> <span class="op">-</span> <span class="va">min_year</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat_test</span> <span class="op">&lt;-</span> <span class="va">dat_test</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>c_stemp <span class="op">=</span> <span class="va">stemp</span> <span class="op">-</span> <span class="va">avgs</span><span class="op">[</span><span class="st">"stemp"</span><span class="op">]</span>,</span>
<span>         c_btemp <span class="op">=</span> <span class="va">btemp</span> <span class="op">-</span> <span class="va">avgs</span><span class="op">[</span><span class="st">"btemp"</span><span class="op">]</span>,</span>
<span>         c_hauls <span class="op">=</span> <span class="va">n_hauls</span> <span class="op">-</span> <span class="va">avgs</span><span class="op">[</span><span class="st">"n_hauls"</span><span class="op">]</span>,</span>
<span>         c_lat   <span class="op">=</span> <span class="va">lat</span> <span class="op">-</span> <span class="va">avgs</span><span class="op">[</span><span class="st">"lat"</span><span class="op">]</span>,</span>
<span>         c_lon   <span class="op">=</span> <span class="va">lon</span> <span class="op">-</span> <span class="va">avgs</span><span class="op">[</span><span class="st">"lon"</span><span class="op">]</span>,</span>
<span>         time  <span class="op">=</span> <span class="va">year</span> <span class="op">-</span> <span class="va">min_year</span><span class="op">)</span></span></code></pre></div>
</div>
<blockquote>
<p>For an extensive list of the explanatory variables available on the dataset, run: <code><a href="../reference/sum_fl.html">?sum_fl</a></code>.</p>
</blockquote>
</section><section class="level2"><h2 id="fitting-and-comparing-models">Fitting and comparing models<a class="anchor" aria-label="anchor" href="#fitting-and-comparing-models"></a>
</h2>
<p>Let’s begin by fitting the simplest DRM available, we will call it our <code>baseline</code>. By default, the simplest <code>fit_drm</code> call assumes two age-groups and a survival rate of <code>0.70</code> between age-classes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">baseline</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/fit_drm.html">fit_drm</a></span><span class="op">(</span>.data <span class="op">=</span> <span class="va">dat_train</span>,</span>
<span>          y_col    <span class="op">=</span> <span class="st">"dens"</span>, <span class="co">## response variable: density</span></span>
<span>          time_col <span class="op">=</span> <span class="st">"year"</span>, <span class="co">## vector of time points</span></span>
<span>          site_col <span class="op">=</span> <span class="st">"patch"</span>,</span>
<span>          seed <span class="op">=</span> <span class="fl">202505</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Running MCMC with 4 parallel chains...

Chain 1 Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 1 Iteration:  100 / 2000 [  5%]  (Warmup) </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Exception: gamma_lpdf: Inverse scale parameter[2] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Exception: gamma_lpdf: Inverse scale parameter[2] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Exception: gamma_lpdf: Inverse scale parameter[1] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Chain 2 Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 2 Iteration:  100 / 2000 [  5%]  (Warmup)
Chain 2 Iteration:  200 / 2000 [ 10%]  (Warmup) </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Exception: gamma_lpdf: Random variable is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Exception: gamma_lpdf: Inverse scale parameter[1] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Exception: gamma_lpdf: Inverse scale parameter[1] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Chain 3 Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 3 Iteration:  100 / 2000 [  5%]  (Warmup)
Chain 3 Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 3 Iteration:  300 / 2000 [ 15%]  (Warmup) </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Exception: gamma_lpdf: Random variable is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Exception: gamma_lpdf: Inverse scale parameter[1] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Exception: gamma_lpdf: Inverse scale parameter[1] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Chain 4 Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 4 Iteration:  100 / 2000 [  5%]  (Warmup)
Chain 4 Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 4 Iteration:  300 / 2000 [ 15%]  (Warmup) </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Exception: gamma_lpdf: Inverse scale parameter[1] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Exception: gamma_lpdf: Inverse scale parameter[1] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Chain 1 Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 1 Iteration:  300 / 2000 [ 15%]  (Warmup)
Chain 1 Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 1 Iteration:  500 / 2000 [ 25%]  (Warmup) </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Exception: gamma_lpdf: Inverse scale parameter[1] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Chain 2 Iteration:  300 / 2000 [ 15%]  (Warmup)
Chain 2 Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 2 Iteration:  500 / 2000 [ 25%]  (Warmup)
Chain 3 Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 3 Iteration:  500 / 2000 [ 25%]  (Warmup)
Chain 4 Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 1 Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 1 Iteration:  700 / 2000 [ 35%]  (Warmup)
Chain 2 Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 2 Iteration:  700 / 2000 [ 35%]  (Warmup)
Chain 3 Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 4 Iteration:  500 / 2000 [ 25%]  (Warmup)
Chain 4 Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 1 Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 1 Iteration:  900 / 2000 [ 45%]  (Warmup)
Chain 2 Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 2 Iteration:  900 / 2000 [ 45%]  (Warmup)
Chain 3 Iteration:  700 / 2000 [ 35%]  (Warmup)
Chain 3 Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 4 Iteration:  700 / 2000 [ 35%]  (Warmup)
Chain 4 Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 1 Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 1 Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 2 Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 2 Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 3 Iteration:  900 / 2000 [ 45%]  (Warmup)
Chain 3 Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 3 Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 4 Iteration:  900 / 2000 [ 45%]  (Warmup) </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Exception: gamma_lpdf: Inverse scale parameter[1] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Chain 1 Iteration: 1100 / 2000 [ 55%]  (Sampling)
Chain 2 Iteration: 1100 / 2000 [ 55%]  (Sampling)
Chain 4 Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 4 Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 1 Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 3 Iteration: 1100 / 2000 [ 55%]  (Sampling)
Chain 4 Iteration: 1100 / 2000 [ 55%]  (Sampling)
Chain 2 Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 3 Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 4 Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 1 Iteration: 1300 / 2000 [ 65%]  (Sampling)
Chain 2 Iteration: 1300 / 2000 [ 65%]  (Sampling)
Chain 3 Iteration: 1300 / 2000 [ 65%]  (Sampling)
Chain 1 Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 4 Iteration: 1300 / 2000 [ 65%]  (Sampling)
Chain 1 Iteration: 1500 / 2000 [ 75%]  (Sampling)
Chain 2 Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 3 Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 4 Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 2 Iteration: 1500 / 2000 [ 75%]  (Sampling)
Chain 3 Iteration: 1500 / 2000 [ 75%]  (Sampling)
Chain 4 Iteration: 1500 / 2000 [ 75%]  (Sampling)
Chain 1 Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 2 Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 3 Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 1 Iteration: 1700 / 2000 [ 85%]  (Sampling)
Chain 4 Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 1 Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 2 Iteration: 1700 / 2000 [ 85%]  (Sampling)
Chain 3 Iteration: 1700 / 2000 [ 85%]  (Sampling)
Chain 4 Iteration: 1700 / 2000 [ 85%]  (Sampling)
Chain 2 Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 3 Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 4 Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 1 Iteration: 1900 / 2000 [ 95%]  (Sampling)
Chain 2 Iteration: 1900 / 2000 [ 95%]  (Sampling)
Chain 1 Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 3 Iteration: 1900 / 2000 [ 95%]  (Sampling)
Chain 4 Iteration: 1900 / 2000 [ 95%]  (Sampling)
Chain 1 finished in 2.2 seconds.
Chain 2 Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 3 Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 4 Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 2 finished in 2.2 seconds.
Chain 3 finished in 2.2 seconds.
Chain 4 finished in 2.2 seconds.

All 4 chains finished successfully.
Mean chain execution time: 2.2 seconds.
Total execution time: 2.4 seconds.</code></pre>
</div>
</div>
<p>This function has many arguments. We need to input at least the following:</p>
<ul>
<li><p><code>.data</code> - a <code>data.frame</code>;</p></li>
<li><p><code>y_col</code> - a <code>character</code> indicating the name of the column (or variable) storing the response variable in <code>.data</code>.</p></li>
<li><p><code>time_col</code> - a <code>character</code> indicating the name of the column (or variable) storing the time variable in <code>.data</code>.</p></li>
<li><p><code>site_col</code> - a <code>character</code> indicating the name of the column (or variable) storing the site variable in <code>.data</code>.</p></li>
<li><p><code>seed</code> - a <code>integer</code> corresponding to a seed for random number generation. This parameter helps to ensure reproducibility.</p></li>
</ul>
<p>Moreover, the output of a <code>fit_drm</code> call results in a named list. Its most important element is the <code>stanfit</code>, which is equivalent to the output of <a href="%60sample()%60">https://mc-stan.org/cmdstanr/reference/model-method-sample.html</a>. The remaining additional elements are useful for calculating predictions.</p>
<p>It is more interesting to have the expected density and probabilities of absence varying according to environmental variables. To achieve that, we input formulas to the <code>formula_zero</code> and <code>formula_rec</code> arguments. The specific call to <code>fit_drm</code> is as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">drm_1</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/fit_drm.html">fit_drm</a></span><span class="op">(</span>.data <span class="op">=</span> <span class="va">dat_train</span>,</span>
<span>          y_col <span class="op">=</span> <span class="st">"dens"</span>,</span>
<span>          time_col <span class="op">=</span> <span class="st">"year"</span>,</span>
<span>          site_col <span class="op">=</span> <span class="st">"patch"</span>,</span>
<span>          seed <span class="op">=</span> <span class="fl">202505</span>,</span>
<span>          formula_zero <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">c_hauls</span> <span class="op">+</span> <span class="va">c_btemp</span> <span class="op">+</span> <span class="va">c_stemp</span>,</span>
<span>          formula_rec <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">c_stemp</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">c_stemp</span> <span class="op">*</span> <span class="va">c_stemp</span><span class="op">)</span>,</span>
<span>          init <span class="op">=</span> <span class="st">"pathfinder"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Path [1] :Initial log joint density = -29332.280161
Exception: gamma_lpdf: Inverse scale parameter[3] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)
Exception: gamma_lpdf: Inverse scale parameter[9] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)
Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
             99      -3.351e+02      9.060e-03   3.551e+00    1.000e+00  1.000e+00      2476 -3.541e+02 -3.541e+02
Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            199      -3.350e+02      3.676e-04   6.584e-01    7.242e-01  7.242e-01      4976 -3.532e+02 -3.532e+02
Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            231      -3.350e+02      2.314e-04   5.325e-02    1.000e+00  1.000e+00      5776 -3.523e+02 -3.523e+02
Path [1] :Best Iter: [206] ELBO (-351.435953) evaluations: (5776)
Rejecting initial value:
  Log probability evaluates to log(0), i.e. negative infinity.
  Stan can't start sampling from this initial value.
Path [2] :Initial log joint density = -44519.591940
Exception: gamma_lpdf: Inverse scale parameter[3] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)
Error evaluating model log probability: Non-finite gradient.
Error evaluating model log probability: Non-finite gradient.
Path [2] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
             99      -3.351e+02      6.742e-03   3.440e+00    3.184e-01  1.000e+00      2476 -3.523e+02 -3.523e+02
Path [2] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            199      -3.350e+02      1.270e-03   3.261e+00    9.233e-01  9.233e-01      4976 -3.537e+02 -3.537e+02
Path [2] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            275      -3.350e+02      2.247e-05   1.501e-01    1.220e-01  8.932e-01      6876 -3.541e+02 -3.541e+02
Path [2] :Best Iter: [260] ELBO (-351.475713) evaluations: (6876)
Path [3] :Initial log joint density = -186058967310.883301
Path [3] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
              1      -1.861e+11      0.000e+00   8.911e+12    1.000e-03  1.000e-03         1        nan       -inf
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Path [4] :Initial log joint density = -945658204811246466058678173696.000000
Path [4] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
              1      -9.457e+29      0.000e+00   4.672e+31    1.000e-03  1.000e-03         1        nan       -inf
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Total log probability function evaluations:14602 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Optimization terminated with error: Line search failed to achieve a sufficient decrease, no more progress can be made Optimization failed to start, pathfinder cannot be run.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Pathfinder iteration: 2 failed.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Optimization terminated with error: Line search failed to achieve a sufficient decrease, no more progress can be made Optimization failed to start, pathfinder cannot be run.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Pathfinder iteration: 3 failed.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Finished in  1.4 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Pareto k-hat = 0.81. Sample size is too small, for given Pareto k-hat. Sample size larger than 214113 is needed for reliable results.
 Bias dominates when k-hat &gt; 0.7, making empirical mean estimate of the Pareto-smoothed draws unreliable.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Init values were only set for a subset of parameters.
Missing init values for the following parameters:
 - chain 1: sigma_obs, beta_s, log_tau, alpha, raw, zeta
 - chain 2: sigma_obs, beta_s, log_tau, alpha, raw, zeta
 - chain 3: sigma_obs, beta_s, log_tau, alpha, raw, zeta
 - chain 4: sigma_obs, beta_s, log_tau, alpha, raw, zeta

To disable this message use options(cmdstanr_warn_inits = FALSE).</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Running MCMC with 4 parallel chains...

Chain 1 Iteration:    1 / 2000 [  0%]  (Warmup) </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Exception: gamma_lpdf: Inverse scale parameter[3] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Exception: gamma_lpdf: Inverse scale parameter[3] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Exception: gamma_lpdf: Inverse scale parameter[3] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Exception: gamma_lpdf: Random variable is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Exception: gamma_lpdf: Inverse scale parameter[3] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Chain 2 Iteration:    1 / 2000 [  0%]  (Warmup) </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Exception: gamma_lpdf: Inverse scale parameter[2] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Exception: gamma_lpdf: Inverse scale parameter[2] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Exception: gamma_lpdf: Inverse scale parameter[2] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Exception: gamma_lpdf: Inverse scale parameter[3] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Exception: gamma_lpdf: Inverse scale parameter[3] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Chain 3 Iteration:    1 / 2000 [  0%]  (Warmup) </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Exception: gamma_lpdf: Inverse scale parameter[2] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Exception: gamma_lpdf: Inverse scale parameter[2] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Exception: gamma_lpdf: Inverse scale parameter[2] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Exception: gamma_lpdf: Random variable is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Exception: gamma_lpdf: Inverse scale parameter[2] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Chain 4 Iteration:    1 / 2000 [  0%]  (Warmup) </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Exception: gamma_lpdf: Inverse scale parameter[168] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Exception: gamma_lpdf: Inverse scale parameter[168] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Exception: gamma_lpdf: Inverse scale parameter[3] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Exception: gamma_lpdf: Inverse scale parameter[3] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Chain 2 Iteration:  100 / 2000 [  5%]  (Warmup)
Chain 1 Iteration:  100 / 2000 [  5%]  (Warmup)
Chain 3 Iteration:  100 / 2000 [  5%]  (Warmup)
Chain 4 Iteration:  100 / 2000 [  5%]  (Warmup)
Chain 2 Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 1 Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 2 Iteration:  300 / 2000 [ 15%]  (Warmup)
Chain 3 Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 4 Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 1 Iteration:  300 / 2000 [ 15%]  (Warmup)
Chain 2 Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 3 Iteration:  300 / 2000 [ 15%]  (Warmup)
Chain 4 Iteration:  300 / 2000 [ 15%]  (Warmup)
Chain 1 Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 2 Iteration:  500 / 2000 [ 25%]  (Warmup)
Chain 3 Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 4 Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 1 Iteration:  500 / 2000 [ 25%]  (Warmup)
Chain 2 Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 3 Iteration:  500 / 2000 [ 25%]  (Warmup)
Chain 4 Iteration:  500 / 2000 [ 25%]  (Warmup)
Chain 2 Iteration:  700 / 2000 [ 35%]  (Warmup)
Chain 1 Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 4 Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 2 Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 3 Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 4 Iteration:  700 / 2000 [ 35%]  (Warmup)
Chain 1 Iteration:  700 / 2000 [ 35%]  (Warmup)
Chain 2 Iteration:  900 / 2000 [ 45%]  (Warmup)
Chain 3 Iteration:  700 / 2000 [ 35%]  (Warmup)
Chain 1 Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 4 Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 2 Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 2 Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 3 Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 4 Iteration:  900 / 2000 [ 45%]  (Warmup)
Chain 1 Iteration:  900 / 2000 [ 45%]  (Warmup)
Chain 3 Iteration:  900 / 2000 [ 45%]  (Warmup)
Chain 1 Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 1 Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 4 Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 4 Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 3 Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 3 Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 2 Iteration: 1100 / 2000 [ 55%]  (Sampling)
Chain 3 Iteration: 1100 / 2000 [ 55%]  (Sampling)
Chain 4 Iteration: 1100 / 2000 [ 55%]  (Sampling)
Chain 1 Iteration: 1100 / 2000 [ 55%]  (Sampling)
Chain 2 Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 3 Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 4 Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 1 Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 4 Iteration: 1300 / 2000 [ 65%]  (Sampling)
Chain 2 Iteration: 1300 / 2000 [ 65%]  (Sampling)
Chain 3 Iteration: 1300 / 2000 [ 65%]  (Sampling)
Chain 1 Iteration: 1300 / 2000 [ 65%]  (Sampling)
Chain 3 Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 4 Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 2 Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 1 Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 3 Iteration: 1500 / 2000 [ 75%]  (Sampling)
Chain 4 Iteration: 1500 / 2000 [ 75%]  (Sampling)
Chain 2 Iteration: 1500 / 2000 [ 75%]  (Sampling)
Chain 1 Iteration: 1500 / 2000 [ 75%]  (Sampling)
Chain 3 Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 4 Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 1 Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 2 Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 3 Iteration: 1700 / 2000 [ 85%]  (Sampling)
Chain 4 Iteration: 1700 / 2000 [ 85%]  (Sampling)
Chain 1 Iteration: 1700 / 2000 [ 85%]  (Sampling)
Chain 2 Iteration: 1700 / 2000 [ 85%]  (Sampling)
Chain 3 Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 4 Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 1 Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 3 Iteration: 1900 / 2000 [ 95%]  (Sampling)
Chain 4 Iteration: 1900 / 2000 [ 95%]  (Sampling)
Chain 2 Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 3 Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 3 finished in 7.4 seconds.
Chain 1 Iteration: 1900 / 2000 [ 95%]  (Sampling)
Chain 2 Iteration: 1900 / 2000 [ 95%]  (Sampling)
Chain 4 Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 4 finished in 7.4 seconds.
Chain 1 Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 2 Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 1 finished in 7.7 seconds.
Chain 2 finished in 7.7 seconds.

All 4 chains finished successfully.
Mean chain execution time: 7.5 seconds.
Total execution time: 7.8 seconds.</code></pre>
</div>
</div>
<p>In this call we also introduce the <code>init</code> argument. This argument controls how the MCMC algorithm is initialized. There are three different initialization options:</p>
<ul>
<li><p><code>"default"</code>: the default initialization method in <code>cmdstan</code>.</p></li>
<li><p><code>"prior"</code>: Initializes the parameters with samples from their prior distributions.</p></li>
<li><p><code>"pathfinder"</code>: Uses the Pathfinder algorithm <span class="citation" data-cites="zhang2022pathfinder">(<a href="#ref-zhang2022pathfinder" role="doc-biblioref">Zhang et al. 2022</a>)</span> for the initialization.</p></li>
</ul>
<p>For further info, see <code><a href="../reference/fit_drm.html">?fit_drm</a></code>.</p>
<p>We can easily fit several models to a specific dataset, exploring different features and increasing levels of complexity. The simplest model was the <code>baseline</code>. Building upon this, <code>drm_1</code> introduced specific covariate effects, modeling recruitment as a quadratic function of Sea Surface Temperature (SST) and the probability of absence as dependent on the number of hauls, SST, and Sea Bottom Temperature (SBT).</p>
<p>In the code chunk below, model <code>drm_2</code> adds the estimation of a constant survival rate to the features of <code>drm_1</code>. Subsequently, <code>drm_3</code> incorporated an AR(1) temporal autocorrelation process for recruitment based on <code>drm_2</code>. Several variations are then built upon <code>drm_3</code>. Model <code>drm_4</code> introduces spatial movement dynamics and increased the number of age classes to six. In contrast, <code>drm_5</code> also increases the age classes to six but does not include movement. Model <code>drm_6</code> adds age-specific fishing mortality rates for 16 distinct age classes at each time point. Another variant, <code>drm_7</code>, modifies the <code>drm_3</code> structure: it retains the same formulation for the probability of absence but models recruitment with an AR(1) process that is constant across patches, and makes survival dependent on SBT.</p>
<p>Finally, for comparison, to a different class of model, <code>sdm</code>, was fitted. This was specified as a zero-augmented Gamma SDM where the absence probability component followed the structure used in <code>drm_3</code>, and the conditional density (for positive observations) was modeled as a quadratic function of SST.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb215"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">drm_2</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/fit_drm.html">fit_drm</a></span><span class="op">(</span>.data <span class="op">=</span> <span class="va">dat_train</span>,</span>
<span>          y_col <span class="op">=</span> <span class="st">"dens"</span>, <span class="co">## response variable: density</span></span>
<span>          time_col <span class="op">=</span> <span class="st">"year"</span>, <span class="co">## vector of time points</span></span>
<span>          site_col <span class="op">=</span> <span class="st">"patch"</span>,</span>
<span>          seed <span class="op">=</span> <span class="fl">202505</span>,</span>
<span>          formula_zero <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">c_hauls</span> <span class="op">+</span> <span class="va">c_btemp</span> <span class="op">+</span> <span class="va">c_stemp</span>,</span>
<span>          formula_rec <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">c_stemp</span> <span class="op">+</span> <span class="va">c_stemp</span> <span class="op">*</span> <span class="va">c_stemp</span>,</span>
<span>          formula_surv <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>          m <span class="op">=</span> <span class="fl">0</span>,</span>
<span>          .toggles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>est_surv <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>          init <span class="op">=</span> <span class="st">"pathfinder"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">drm_2</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/fit_drm.html">fit_drm</a></span><span class="op">(</span>.data <span class="op">=</span> <span class="va">dat_train</span>,</span>
<span>          y_col <span class="op">=</span> <span class="st">"dens"</span>, <span class="co">## response variable: density</span></span>
<span>          time_col <span class="op">=</span> <span class="st">"year"</span>, <span class="co">## vector of time points</span></span>
<span>          site_col <span class="op">=</span> <span class="st">"patch"</span>,</span>
<span>          seed <span class="op">=</span> <span class="fl">202505</span>,</span>
<span>          formula_zero <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">c_hauls</span> <span class="op">+</span> <span class="va">c_btemp</span> <span class="op">+</span> <span class="va">c_stemp</span>,</span>
<span>          formula_rec <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">c_stemp</span> <span class="op">+</span> <span class="va">c_stemp</span> <span class="op">*</span> <span class="va">c_stemp</span>,</span>
<span>          formula_surv <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>          m <span class="op">=</span> <span class="fl">0</span>,</span>
<span>          .toggles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>est_surv <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>          init <span class="op">=</span> <span class="st">"pathfinder"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">drm_3</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/fit_drm.html">fit_drm</a></span><span class="op">(</span>.data <span class="op">=</span> <span class="va">dat_train</span>,</span>
<span>          y_col <span class="op">=</span> <span class="st">"dens"</span>, <span class="co">## response variable: density</span></span>
<span>          time_col <span class="op">=</span> <span class="st">"year"</span>, <span class="co">## vector of time points</span></span>
<span>          site_col <span class="op">=</span> <span class="st">"patch"</span>,</span>
<span>          seed <span class="op">=</span> <span class="fl">202505</span>,</span>
<span>          formula_zero <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">c_hauls</span> <span class="op">+</span> <span class="va">c_btemp</span> <span class="op">+</span> <span class="va">c_stemp</span>,</span>
<span>          formula_rec <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">c_stemp</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">c_stemp</span> <span class="op">*</span> <span class="va">c_stemp</span><span class="op">)</span>,</span>
<span>          formula_surv <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>          .toggles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>est_surv <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                          time_ar <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>          init <span class="op">=</span> <span class="st">"pathfinder"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">adj_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gen_adj.html">gen_adj</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_unary.html" class="external-link">st_buffer</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">polygons</span><span class="op">)</span>,</span>
<span>                             dist <span class="op">=</span> <span class="fl">2500</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## row-standardized matrix</span></span>
<span><span class="va">adj_mat</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">adj_mat</span>, <span class="fl">1</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span> <span class="op">/</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">drm_4</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/fit_drm.html">fit_drm</a></span><span class="op">(</span>.data <span class="op">=</span> <span class="va">dat_train</span>,</span>
<span>          y_col <span class="op">=</span> <span class="st">"dens"</span>, <span class="co">## response variable: density</span></span>
<span>          time_col <span class="op">=</span> <span class="st">"year"</span>, <span class="co">## vector of time points</span></span>
<span>          site_col <span class="op">=</span> <span class="st">"patch"</span>,</span>
<span>          family <span class="op">=</span> <span class="st">"gamma"</span>,</span>
<span>          seed <span class="op">=</span> <span class="fl">202505</span>,</span>
<span>          formula_zero <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">c_hauls</span> <span class="op">+</span> <span class="va">c_btemp</span> <span class="op">+</span> <span class="va">c_stemp</span>,</span>
<span>          formula_rec <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">c_stemp</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">c_stemp</span> <span class="op">*</span> <span class="va">c_stemp</span><span class="op">)</span>,</span>
<span>          formula_surv <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>          n_ages <span class="op">=</span> <span class="fl">6</span>,</span>
<span>          adj_mat <span class="op">=</span> <span class="va">adj_mat</span>, <span class="co">## A matrix for movement routine</span></span>
<span>          ages_movement <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>, <span class="co">## ages allowed to move</span></span>
<span>          .toggles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>est_surv <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                          time_ar <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                          movement <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>          init <span class="op">=</span> <span class="st">"pathfinder"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">drm_5</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/fit_drm.html">fit_drm</a></span><span class="op">(</span>.data <span class="op">=</span> <span class="va">dat_train</span>,</span>
<span>          y_col <span class="op">=</span> <span class="st">"dens"</span>, <span class="co">## response variable: density</span></span>
<span>          time_col <span class="op">=</span> <span class="st">"year"</span>, <span class="co">## vector of time points</span></span>
<span>          site_col <span class="op">=</span> <span class="st">"patch"</span>,</span>
<span>          family <span class="op">=</span> <span class="st">"gamma"</span>,</span>
<span>          seed <span class="op">=</span> <span class="fl">202505</span>,</span>
<span>          formula_zero <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">c_hauls</span> <span class="op">+</span> <span class="va">c_btemp</span> <span class="op">+</span> <span class="va">c_stemp</span>,</span>
<span>          formula_rec <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">c_stemp</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">c_stemp</span> <span class="op">*</span> <span class="va">c_stemp</span><span class="op">)</span>,</span>
<span>          formula_surv <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>          n_ages <span class="op">=</span> <span class="fl">6</span>,</span>
<span>          .toggles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>est_surv <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                          time_ar <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>          init <span class="op">=</span> <span class="st">"pathfinder"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## instantaneous fishing mortality rates</span></span>
<span><span class="va">fmat</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"fmat.rds"</span>, package <span class="op">=</span> <span class="st">"drmr"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">f_train</span> <span class="op">&lt;-</span> <span class="va">fmat</span><span class="op">[</span>, <span class="va">years_train</span><span class="op">]</span></span>
<span><span class="va">f_test</span>  <span class="op">&lt;-</span> <span class="va">fmat</span><span class="op">[</span>, <span class="va">years_test</span><span class="op">]</span></span>
<span></span>
<span><span class="va">drm_6</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/fit_drm.html">fit_drm</a></span><span class="op">(</span>.data <span class="op">=</span> <span class="va">dat_train</span>,</span>
<span>          y_col <span class="op">=</span> <span class="st">"dens"</span>, <span class="co">## response variable: density</span></span>
<span>          time_col <span class="op">=</span> <span class="st">"year"</span>, <span class="co">## vector of time points</span></span>
<span>          site_col <span class="op">=</span> <span class="st">"patch"</span>,</span>
<span>          family <span class="op">=</span> <span class="st">"gamma"</span>,</span>
<span>          seed <span class="op">=</span> <span class="fl">202505</span>,</span>
<span>          formula_zero <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">c_hauls</span> <span class="op">+</span> <span class="va">c_btemp</span> <span class="op">+</span> <span class="va">c_stemp</span>,</span>
<span>          formula_rec <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">c_stemp</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">c_stemp</span> <span class="op">*</span> <span class="va">c_stemp</span><span class="op">)</span>,</span>
<span>          formula_surv <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>          n_ages <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">NROW</a></span><span class="op">(</span><span class="va">f_train</span><span class="op">)</span>,</span>
<span>          f_mort <span class="op">=</span> <span class="va">f_train</span>,</span>
<span>          .toggles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>time_ar <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                          est_surv <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>          init <span class="op">=</span> <span class="st">"pathfinder"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">drm_7</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/fit_drm.html">fit_drm</a></span><span class="op">(</span>.data <span class="op">=</span> <span class="va">dat_train</span>,</span>
<span>          y_col <span class="op">=</span> <span class="st">"dens"</span>, <span class="co">## response variable: density</span></span>
<span>          time_col <span class="op">=</span> <span class="st">"year"</span>, <span class="co">## vector of time points</span></span>
<span>          site_col <span class="op">=</span> <span class="st">"patch"</span>,</span>
<span>          family <span class="op">=</span> <span class="st">"gamma"</span>,</span>
<span>          seed <span class="op">=</span> <span class="fl">202505</span>,</span>
<span>          formula_zero <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">c_hauls</span> <span class="op">+</span> <span class="va">c_btemp</span> <span class="op">+</span> <span class="va">c_stemp</span>,</span>
<span>          formula_rec <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>          formula_surv <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">c_btemp</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">c_btemp</span> <span class="op">*</span> <span class="va">c_btemp</span><span class="op">)</span>,</span>
<span>          .toggles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>time_ar <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                          est_surv <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>          init <span class="op">=</span> <span class="st">"pathfinder"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sdm</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/fit_sdm.html">fit_sdm</a></span><span class="op">(</span>.data <span class="op">=</span> <span class="va">dat_train</span>,</span>
<span>          y_col <span class="op">=</span> <span class="st">"dens"</span>, <span class="co">## response variable: density</span></span>
<span>          time_col <span class="op">=</span> <span class="st">"year"</span>, <span class="co">## vector of time points</span></span>
<span>          site_col <span class="op">=</span> <span class="st">"patch"</span>,</span>
<span>          seed <span class="op">=</span> <span class="fl">202505</span>,</span>
<span>          formula_zero <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">c_hauls</span> <span class="op">+</span> <span class="va">c_btemp</span> <span class="op">+</span> <span class="va">c_stemp</span>,</span>
<span>          formula_dens <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">c_stemp</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">c_stemp</span> <span class="op">*</span> <span class="va">c_stemp</span><span class="op">)</span>,</span>
<span>          .toggles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>time_ar <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>          init <span class="op">=</span> <span class="st">"pathfinder"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Path [1] :Initial log joint density = -3627015.060761
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Inverse scale parameter[2] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)
Exception: gamma_lpdf: Inverse scale parameter[2] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)
Exception: gamma_lpdf: Inverse scale parameter[2] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)
Exception: gamma_lpdf: Inverse scale parameter[2] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)
Exception: gamma_lpdf: Inverse scale parameter[2] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)
Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
             99      -3.438e+02      8.997e-03   1.170e+00    1.000e+00  1.000e+00      2476 -3.572e+02 -3.572e+02
Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            116      -3.438e+02      9.024e-05   2.240e-02    9.806e-01  9.806e-01      2901 -3.591e+02 -3.591e+02
Path [1] :Best Iter: [110] ELBO (-356.678927) evaluations: (2901)
Rejecting initial value:
  Log probability evaluates to log(0), i.e. negative infinity.
  Stan can't start sampling from this initial value.
Rejecting initial value:
  Log probability evaluates to log(0), i.e. negative infinity.
  Stan can't start sampling from this initial value.
Path [2] :Initial log joint density = -7516.938163
Error evaluating model log probability: Non-finite gradient.
Path [2] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
             99      -3.438e+02      8.570e-03   1.167e+00    3.868e-01  1.000e+00      2476 -3.574e+02 -3.574e+02
Path [2] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            151      -3.438e+02      2.210e-04   1.938e-02    1.000e+00  1.000e+00      3776 -3.582e+02 -3.582e+02
Path [2] :Best Iter: [72] ELBO (-356.429973) evaluations: (3776)
Rejecting initial value:
  Log probability evaluates to log(0), i.e. negative infinity.
  Stan can't start sampling from this initial value.
Rejecting initial value:
  Log probability evaluates to log(0), i.e. negative infinity.
  Stan can't start sampling from this initial value.
Rejecting initial value:
  Log probability evaluates to log(0), i.e. negative infinity.
  Stan can't start sampling from this initial value.
Rejecting initial value:
  Log probability evaluates to log(0), i.e. negative infinity.
  Stan can't start sampling from this initial value.
Path [3] :Initial log joint density = -35302.401736
Exception: gamma_lpdf: Inverse scale parameter[2] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)
Exception: gamma_lpdf: Inverse scale parameter[2] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)
Path [3] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
             99      -3.438e+02      1.206e-02   1.792e+00    1.000e+00  1.000e+00      2476 -3.577e+02 -3.577e+02
Path [3] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            143      -3.438e+02      1.872e-04   3.654e-02    1.000e+00  1.000e+00      3576 -3.566e+02 -3.566e+02
Path [3] :Best Iter: [120] ELBO (-356.471115) evaluations: (3576)
Rejecting initial value:
  Log probability evaluates to log(0), i.e. negative infinity.
  Stan can't start sampling from this initial value.
Path [4] :Initial log joint density = -21356.995897
Exception: gamma_lpdf: Inverse scale parameter[2] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)
Path [4] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
             95      -3.438e+02      2.193e-04   3.070e-02    1.000e+00  1.000e+00      2376 -3.575e+02 -3.575e+02
Path [4] :Best Iter: [65] ELBO (-356.090439) evaluations: (2376)
Total log probability function evaluations:16529
Finished in  2.5 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Pareto k-hat = 0.7.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Init values were only set for a subset of parameters.
Missing init values for the following parameters:
 - chain 1: sigma_obs, log_tau, alpha, raw, zeta
 - chain 2: sigma_obs, log_tau, alpha, raw, zeta
 - chain 3: sigma_obs, log_tau, alpha, raw, zeta
 - chain 4: sigma_obs, log_tau, alpha, raw, zeta

To disable this message use options(cmdstanr_warn_inits = FALSE).</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Running MCMC with 4 parallel chains...

Chain 1 Iteration:    1 / 2000 [  0%]  (Warmup) </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Chain 2 Iteration:    1 / 2000 [  0%]  (Warmup) </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Exception: gamma_lpdf: Inverse scale parameter[2] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Chain 3 Iteration:    1 / 2000 [  0%]  (Warmup) </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Exception: gamma_lpdf: Inverse scale parameter[2] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Chain 4 Iteration:    1 / 2000 [  0%]  (Warmup) </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Exception: gamma_lpdf: Inverse scale parameter[2] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Chain 1 Iteration:  100 / 2000 [  5%]  (Warmup)
Chain 2 Iteration:  100 / 2000 [  5%]  (Warmup)
Chain 3 Iteration:  100 / 2000 [  5%]  (Warmup)
Chain 4 Iteration:  100 / 2000 [  5%]  (Warmup)
Chain 1 Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 2 Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 3 Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 1 Iteration:  300 / 2000 [ 15%]  (Warmup)
Chain 4 Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 2 Iteration:  300 / 2000 [ 15%]  (Warmup)
Chain 3 Iteration:  300 / 2000 [ 15%]  (Warmup)
Chain 1 Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 4 Iteration:  300 / 2000 [ 15%]  (Warmup)
Chain 2 Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 3 Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 4 Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 1 Iteration:  500 / 2000 [ 25%]  (Warmup)
Chain 2 Iteration:  500 / 2000 [ 25%]  (Warmup)
Chain 3 Iteration:  500 / 2000 [ 25%]  (Warmup)
Chain 4 Iteration:  500 / 2000 [ 25%]  (Warmup)
Chain 1 Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 2 Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 3 Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 2 Iteration:  700 / 2000 [ 35%]  (Warmup)
Chain 4 Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 1 Iteration:  700 / 2000 [ 35%]  (Warmup)
Chain 3 Iteration:  700 / 2000 [ 35%]  (Warmup)
Chain 2 Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 4 Iteration:  700 / 2000 [ 35%]  (Warmup)
Chain 1 Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 3 Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 1 Iteration:  900 / 2000 [ 45%]  (Warmup)
Chain 2 Iteration:  900 / 2000 [ 45%]  (Warmup)
Chain 3 Iteration:  900 / 2000 [ 45%]  (Warmup)
Chain 4 Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 4 Iteration:  900 / 2000 [ 45%]  (Warmup)
Chain 1 Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 1 Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 2 Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 2 Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 3 Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 3 Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 4 Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 4 Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 1 Iteration: 1100 / 2000 [ 55%]  (Sampling)
Chain 2 Iteration: 1100 / 2000 [ 55%]  (Sampling)
Chain 3 Iteration: 1100 / 2000 [ 55%]  (Sampling)
Chain 4 Iteration: 1100 / 2000 [ 55%]  (Sampling)
Chain 1 Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 2 Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 3 Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 4 Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 1 Iteration: 1300 / 2000 [ 65%]  (Sampling)
Chain 2 Iteration: 1300 / 2000 [ 65%]  (Sampling)
Chain 3 Iteration: 1300 / 2000 [ 65%]  (Sampling)
Chain 4 Iteration: 1300 / 2000 [ 65%]  (Sampling)
Chain 1 Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 2 Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 3 Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 4 Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 1 Iteration: 1500 / 2000 [ 75%]  (Sampling)
Chain 2 Iteration: 1500 / 2000 [ 75%]  (Sampling)
Chain 3 Iteration: 1500 / 2000 [ 75%]  (Sampling)
Chain 4 Iteration: 1500 / 2000 [ 75%]  (Sampling)
Chain 1 Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 2 Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 4 Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 3 Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 1 Iteration: 1700 / 2000 [ 85%]  (Sampling)
Chain 2 Iteration: 1700 / 2000 [ 85%]  (Sampling)
Chain 4 Iteration: 1700 / 2000 [ 85%]  (Sampling)
Chain 2 Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 3 Iteration: 1700 / 2000 [ 85%]  (Sampling)
Chain 1 Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 4 Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 3 Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 1 Iteration: 1900 / 2000 [ 95%]  (Sampling)
Chain 2 Iteration: 1900 / 2000 [ 95%]  (Sampling)
Chain 4 Iteration: 1900 / 2000 [ 95%]  (Sampling)
Chain 1 Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 2 Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 3 Iteration: 1900 / 2000 [ 95%]  (Sampling)
Chain 1 finished in 7.9 seconds.
Chain 2 finished in 7.8 seconds.
Chain 4 Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 4 finished in 7.9 seconds.
Chain 3 Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 3 finished in 8.1 seconds.

All 4 chains finished successfully.
Mean chain execution time: 7.9 seconds.
Total execution time: 8.1 seconds.

Path [1] :Initial log joint density = -3627015.060761
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Inverse scale parameter[2] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)
Exception: gamma_lpdf: Inverse scale parameter[2] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)
Exception: gamma_lpdf: Inverse scale parameter[2] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)
Exception: gamma_lpdf: Inverse scale parameter[2] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)
Exception: gamma_lpdf: Inverse scale parameter[2] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)
Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
             99      -3.438e+02      8.997e-03   1.170e+00    1.000e+00  1.000e+00      2476 -3.572e+02 -3.572e+02
Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            116      -3.438e+02      9.024e-05   2.240e-02    9.806e-01  9.806e-01      2901 -3.591e+02 -3.591e+02
Path [1] :Best Iter: [110] ELBO (-356.678927) evaluations: (2901)
Rejecting initial value:
  Log probability evaluates to log(0), i.e. negative infinity.
  Stan can't start sampling from this initial value.
Rejecting initial value:
  Log probability evaluates to log(0), i.e. negative infinity.
  Stan can't start sampling from this initial value.
Path [2] :Initial log joint density = -7516.938163
Error evaluating model log probability: Non-finite gradient.
Path [2] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
             99      -3.438e+02      8.570e-03   1.167e+00    3.868e-01  1.000e+00      2476 -3.574e+02 -3.574e+02
Path [2] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            151      -3.438e+02      2.210e-04   1.938e-02    1.000e+00  1.000e+00      3776 -3.582e+02 -3.582e+02
Path [2] :Best Iter: [72] ELBO (-356.429973) evaluations: (3776)
Rejecting initial value:
  Log probability evaluates to log(0), i.e. negative infinity.
  Stan can't start sampling from this initial value.
Rejecting initial value:
  Log probability evaluates to log(0), i.e. negative infinity.
  Stan can't start sampling from this initial value.
Rejecting initial value:
  Log probability evaluates to log(0), i.e. negative infinity.
  Stan can't start sampling from this initial value.
Rejecting initial value:
  Log probability evaluates to log(0), i.e. negative infinity.
  Stan can't start sampling from this initial value.
Path [3] :Initial log joint density = -35302.401736
Exception: gamma_lpdf: Inverse scale parameter[2] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)
Exception: gamma_lpdf: Inverse scale parameter[2] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)
Path [3] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
             99      -3.438e+02      1.206e-02   1.792e+00    1.000e+00  1.000e+00      2476 -3.577e+02 -3.577e+02
Path [3] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            143      -3.438e+02      1.872e-04   3.654e-02    1.000e+00  1.000e+00      3576 -3.566e+02 -3.566e+02
Path [3] :Best Iter: [120] ELBO (-356.471115) evaluations: (3576)
Rejecting initial value:
  Log probability evaluates to log(0), i.e. negative infinity.
  Stan can't start sampling from this initial value.
Path [4] :Initial log joint density = -21356.995897
Exception: gamma_lpdf: Inverse scale parameter[2] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)
Path [4] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
             95      -3.438e+02      2.193e-04   3.070e-02    1.000e+00  1.000e+00      2376 -3.575e+02 -3.575e+02
Path [4] :Best Iter: [65] ELBO (-356.090439) evaluations: (2376)
Total log probability function evaluations:16529
Finished in  2.5 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Pareto k-hat = 0.7.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Init values were only set for a subset of parameters.
Missing init values for the following parameters:
 - chain 1: sigma_obs, log_tau, alpha, raw, zeta
 - chain 2: sigma_obs, log_tau, alpha, raw, zeta
 - chain 3: sigma_obs, log_tau, alpha, raw, zeta
 - chain 4: sigma_obs, log_tau, alpha, raw, zeta

To disable this message use options(cmdstanr_warn_inits = FALSE).</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Running MCMC with 4 parallel chains...

Chain 1 Iteration:    1 / 2000 [  0%]  (Warmup) </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Exception: gamma_lpdf: Inverse scale parameter[1] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Chain 2 Iteration:    1 / 2000 [  0%]  (Warmup) </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Exception: gamma_lpdf: Inverse scale parameter[2] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Chain 3 Iteration:    1 / 2000 [  0%]  (Warmup) </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Exception: gamma_lpdf: Inverse scale parameter[2] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Chain 4 Iteration:    1 / 2000 [  0%]  (Warmup) </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Exception: gamma_lpdf: Inverse scale parameter[3] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Exception: gamma_lpdf: Inverse scale parameter[4] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Chain 2 Iteration:  100 / 2000 [  5%]  (Warmup)
Chain 4 Iteration:  100 / 2000 [  5%]  (Warmup)
Chain 3 Iteration:  100 / 2000 [  5%]  (Warmup)
Chain 1 Iteration:  100 / 2000 [  5%]  (Warmup)
Chain 2 Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 3 Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 4 Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 1 Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 2 Iteration:  300 / 2000 [ 15%]  (Warmup)
Chain 3 Iteration:  300 / 2000 [ 15%]  (Warmup)
Chain 4 Iteration:  300 / 2000 [ 15%]  (Warmup)
Chain 2 Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 1 Iteration:  300 / 2000 [ 15%]  (Warmup)
Chain 4 Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 3 Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 2 Iteration:  500 / 2000 [ 25%]  (Warmup)
Chain 1 Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 4 Iteration:  500 / 2000 [ 25%]  (Warmup)
Chain 3 Iteration:  500 / 2000 [ 25%]  (Warmup)
Chain 2 Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 4 Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 1 Iteration:  500 / 2000 [ 25%]  (Warmup)
Chain 2 Iteration:  700 / 2000 [ 35%]  (Warmup)
Chain 3 Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 4 Iteration:  700 / 2000 [ 35%]  (Warmup)
Chain 3 Iteration:  700 / 2000 [ 35%]  (Warmup)
Chain 2 Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 1 Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 4 Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 2 Iteration:  900 / 2000 [ 45%]  (Warmup)
Chain 3 Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 4 Iteration:  900 / 2000 [ 45%]  (Warmup)
Chain 1 Iteration:  700 / 2000 [ 35%]  (Warmup)
Chain 3 Iteration:  900 / 2000 [ 45%]  (Warmup)
Chain 2 Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 2 Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 1 Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 3 Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 3 Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 4 Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 4 Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 1 Iteration:  900 / 2000 [ 45%]  (Warmup)
Chain 2 Iteration: 1100 / 2000 [ 55%]  (Sampling)
Chain 3 Iteration: 1100 / 2000 [ 55%]  (Sampling)
Chain 4 Iteration: 1100 / 2000 [ 55%]  (Sampling)
Chain 1 Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 1 Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 2 Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 3 Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 4 Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 1 Iteration: 1100 / 2000 [ 55%]  (Sampling)
Chain 2 Iteration: 1300 / 2000 [ 65%]  (Sampling)
Chain 1 Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 3 Iteration: 1300 / 2000 [ 65%]  (Sampling)
Chain 2 Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 4 Iteration: 1300 / 2000 [ 65%]  (Sampling)
Chain 1 Iteration: 1300 / 2000 [ 65%]  (Sampling)
Chain 2 Iteration: 1500 / 2000 [ 75%]  (Sampling)
Chain 3 Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 4 Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 1 Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 2 Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 3 Iteration: 1500 / 2000 [ 75%]  (Sampling)
Chain 4 Iteration: 1500 / 2000 [ 75%]  (Sampling)
Chain 1 Iteration: 1500 / 2000 [ 75%]  (Sampling)
Chain 3 Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 2 Iteration: 1700 / 2000 [ 85%]  (Sampling)
Chain 4 Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 1 Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 3 Iteration: 1700 / 2000 [ 85%]  (Sampling)
Chain 2 Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 1 Iteration: 1700 / 2000 [ 85%]  (Sampling)
Chain 2 Iteration: 1900 / 2000 [ 95%]  (Sampling)
Chain 3 Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 4 Iteration: 1700 / 2000 [ 85%]  (Sampling)
Chain 1 Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 2 Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 3 Iteration: 1900 / 2000 [ 95%]  (Sampling)
Chain 4 Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 2 finished in 7.4 seconds.
Chain 1 Iteration: 1900 / 2000 [ 95%]  (Sampling)
Chain 3 Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 3 finished in 7.7 seconds.
Chain 4 Iteration: 1900 / 2000 [ 95%]  (Sampling)
Chain 1 Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 1 finished in 8.0 seconds.
Chain 4 Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 4 finished in 8.0 seconds.

All 4 chains finished successfully.
Mean chain execution time: 7.8 seconds.
Total execution time: 8.1 seconds.

Path [1] :Initial log joint density = -33280.624747
Exception: gamma_lpdf: Inverse scale parameter[3] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)
Error evaluating model log probability: Non-finite gradient.
Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
             99      -3.732e+02      3.844e-02   2.527e+01    1.000e+00  1.000e+00      2476 -4.376e+02 -4.376e+02
Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            199      -3.510e+02      2.061e-02   2.329e+01    9.101e-01  9.101e-01      4976 -3.728e+02 -3.728e+02
Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            299      -3.463e+02      1.252e-02   4.927e+01    1.000e+00  1.000e+00      7476 -3.812e+02 -3.812e+02
Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            399      -3.423e+02      6.668e-03   2.465e+01    1.727e-01  1.000e+00      9976 -4.065e+02 -4.065e+02
Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            499      -3.410e+02      6.477e-02   4.551e+00    1.000e+00  1.000e+00     12476 -3.806e+02 -3.806e+02
Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            599      -3.407e+02      2.876e-03   9.497e-01    7.462e-01  7.462e-01     14976 -3.691e+02 -3.691e+02
Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            699      -3.406e+02      1.735e-04   1.424e+00    7.293e-01  7.293e-01     17476 -4.072e+02 -4.072e+02
Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            799      -3.406e+02      1.837e-04   6.529e-01    1.000e+00  1.000e+00     19976 -4.036e+02 -4.036e+02
Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            840      -3.406e+02      1.084e-03   1.688e-01    1.000e+00  1.000e+00     21001 -3.899e+02 -3.899e+02
Path [1] :Best Iter: [527] ELBO (-357.716352) evaluations: (21001)
Rejecting initial value:
  Log probability evaluates to log(0), i.e. negative infinity.
  Stan can't start sampling from this initial value.
Rejecting initial value:
  Log probability evaluates to log(0), i.e. negative infinity.
  Stan can't start sampling from this initial value.
Rejecting initial value:
  Log probability evaluates to log(0), i.e. negative infinity.
  Stan can't start sampling from this initial value.
Rejecting initial value:
  Log probability evaluates to log(0), i.e. negative infinity.
  Stan can't start sampling from this initial value.
Rejecting initial value:
  Log probability evaluates to log(0), i.e. negative infinity.
  Stan can't start sampling from this initial value.
Rejecting initial value:
  Log probability evaluates to log(0), i.e. negative infinity.
  Stan can't start sampling from this initial value.
Rejecting initial value:
  Log probability evaluates to log(0), i.e. negative infinity.
  Stan can't start sampling from this initial value.
Rejecting initial value:
  Log probability evaluates to log(0), i.e. negative infinity.
  Stan can't start sampling from this initial value.
Rejecting initial value:
  Log probability evaluates to log(0), i.e. negative infinity.
  Stan can't start sampling from this initial value.
Rejecting initial value:
  Log probability evaluates to log(0), i.e. negative infinity.
  Stan can't start sampling from this initial value.
Rejecting initial value:
  Log probability evaluates to log(0), i.e. negative infinity.
  Stan can't start sampling from this initial value.
Path [2] :Initial log joint density = -257047730684494433862539018240.000000
Path [2] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
              1      -2.570e+29      0.000e+00   1.188e+31    1.000e-03  1.000e-03         1        nan       -inf
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Path [3] :Initial log joint density = -249654833507.378937
Path [3] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
              1      -2.497e+11      0.000e+00   1.165e+13    1.000e-03  1.000e-03         1        nan       -inf
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Path [4] :Initial log joint density = -483295763865767693838855438336.000000
Path [4] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
              1      -4.833e+29      0.000e+00   2.392e+31    1.000e-03  1.000e-03         1        nan       -inf
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Total log probability function evaluations:21976 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Optimization terminated with error: Line search failed to achieve a sufficient decrease, no more progress can be made Optimization failed to start, pathfinder cannot be run.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Pathfinder iteration: 1 failed.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Optimization terminated with error: Line search failed to achieve a sufficient decrease, no more progress can be made Optimization failed to start, pathfinder cannot be run.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Pathfinder iteration: 2 failed.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Optimization terminated with error: Line search failed to achieve a sufficient decrease, no more progress can be made Optimization failed to start, pathfinder cannot be run.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Pathfinder iteration: 3 failed.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Finished in  1.4 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Pareto k-hat = 1.85. Mean does not exist, making empirical mean estimate of the draws not applicable.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Init values were only set for a subset of parameters.
Missing init values for the following parameters:
 - chain 1: sigma_obs, zeta
 - chain 2: sigma_obs, zeta
 - chain 3: sigma_obs, zeta
 - chain 4: sigma_obs, zeta

To disable this message use options(cmdstanr_warn_inits = FALSE).</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Running MCMC with 4 parallel chains...

Chain 1 Iteration:    1 / 2000 [  0%]  (Warmup) </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Exception: gamma_lpdf: Inverse scale parameter[3] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Exception: gamma_lpdf: Inverse scale parameter[3] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Exception: gamma_lpdf: Inverse scale parameter[3] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Exception: gamma_lpdf: Inverse scale parameter[4] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Exception: gamma_lpdf: Inverse scale parameter[1] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Exception: gamma_lpdf: Inverse scale parameter[3] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Chain 2 Iteration:    1 / 2000 [  0%]  (Warmup) </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Exception: gamma_lpdf: Inverse scale parameter[3] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Exception: gamma_lpdf: Inverse scale parameter[3] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Exception: gamma_lpdf: Inverse scale parameter[3] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Exception: gamma_lpdf: Inverse scale parameter[3] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Chain 3 Iteration:    1 / 2000 [  0%]  (Warmup) </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Exception: gamma_lpdf: Inverse scale parameter[3] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Exception: gamma_lpdf: Inverse scale parameter[3] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Exception: gamma_lpdf: Inverse scale parameter[2] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Exception: gamma_lpdf: Inverse scale parameter[162] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Chain 4 Iteration:    1 / 2000 [  0%]  (Warmup) </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Exception: gamma_lpdf: Inverse scale parameter[3] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Exception: gamma_lpdf: Inverse scale parameter[3] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Exception: gamma_lpdf: Inverse scale parameter[3] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Exception: gamma_lpdf: Inverse scale parameter[4] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Exception: gamma_lpdf: Inverse scale parameter[1] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Exception: gamma_lpdf: Inverse scale parameter[2] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Chain 1 Iteration:  100 / 2000 [  5%]  (Warmup)
Chain 3 Iteration:  100 / 2000 [  5%]  (Warmup)
Chain 2 Iteration:  100 / 2000 [  5%]  (Warmup)
Chain 4 Iteration:  100 / 2000 [  5%]  (Warmup)
Chain 1 Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 3 Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 2 Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 4 Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 1 Iteration:  300 / 2000 [ 15%]  (Warmup)
Chain 3 Iteration:  300 / 2000 [ 15%]  (Warmup)
Chain 2 Iteration:  300 / 2000 [ 15%]  (Warmup)
Chain 4 Iteration:  300 / 2000 [ 15%]  (Warmup)
Chain 1 Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 2 Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 3 Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 4 Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 1 Iteration:  500 / 2000 [ 25%]  (Warmup)
Chain 3 Iteration:  500 / 2000 [ 25%]  (Warmup)
Chain 2 Iteration:  500 / 2000 [ 25%]  (Warmup)
Chain 1 Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 4 Iteration:  500 / 2000 [ 25%]  (Warmup)
Chain 2 Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 3 Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 1 Iteration:  700 / 2000 [ 35%]  (Warmup)
Chain 4 Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 3 Iteration:  700 / 2000 [ 35%]  (Warmup)
Chain 1 Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 2 Iteration:  700 / 2000 [ 35%]  (Warmup)
Chain 4 Iteration:  700 / 2000 [ 35%]  (Warmup)
Chain 1 Iteration:  900 / 2000 [ 45%]  (Warmup)
Chain 3 Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 2 Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 4 Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 3 Iteration:  900 / 2000 [ 45%]  (Warmup)
Chain 2 Iteration:  900 / 2000 [ 45%]  (Warmup)
Chain 1 Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 1 Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 4 Iteration:  900 / 2000 [ 45%]  (Warmup)
Chain 3 Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 3 Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 2 Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 2 Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 4 Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 4 Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 1 Iteration: 1100 / 2000 [ 55%]  (Sampling)
Chain 2 Iteration: 1100 / 2000 [ 55%]  (Sampling)
Chain 3 Iteration: 1100 / 2000 [ 55%]  (Sampling)
Chain 4 Iteration: 1100 / 2000 [ 55%]  (Sampling)
Chain 1 Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 3 Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 2 Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 4 Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 1 Iteration: 1300 / 2000 [ 65%]  (Sampling)
Chain 2 Iteration: 1300 / 2000 [ 65%]  (Sampling)
Chain 3 Iteration: 1300 / 2000 [ 65%]  (Sampling)
Chain 4 Iteration: 1300 / 2000 [ 65%]  (Sampling)
Chain 1 Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 3 Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 2 Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 4 Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 1 Iteration: 1500 / 2000 [ 75%]  (Sampling)
Chain 2 Iteration: 1500 / 2000 [ 75%]  (Sampling)
Chain 3 Iteration: 1500 / 2000 [ 75%]  (Sampling)
Chain 4 Iteration: 1500 / 2000 [ 75%]  (Sampling)
Chain 1 Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 2 Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 3 Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 1 Iteration: 1700 / 2000 [ 85%]  (Sampling)
Chain 4 Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 2 Iteration: 1700 / 2000 [ 85%]  (Sampling)
Chain 3 Iteration: 1700 / 2000 [ 85%]  (Sampling)
Chain 4 Iteration: 1700 / 2000 [ 85%]  (Sampling)
Chain 1 Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 2 Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 3 Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 1 Iteration: 1900 / 2000 [ 95%]  (Sampling)
Chain 4 Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 2 Iteration: 1900 / 2000 [ 95%]  (Sampling)
Chain 3 Iteration: 1900 / 2000 [ 95%]  (Sampling)
Chain 4 Iteration: 1900 / 2000 [ 95%]  (Sampling)
Chain 1 Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 1 finished in 24.2 seconds.
Chain 3 Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 3 finished in 24.5 seconds.
Chain 2 Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 2 finished in 24.6 seconds.
Chain 4 Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 4 finished in 24.8 seconds.

All 4 chains finished successfully.
Mean chain execution time: 24.5 seconds.
Total execution time: 24.9 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 1 of 4000 (0.0%) transitions ended with a divergence.
See https://mc-stan.org/misc/warnings for details.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `sum_fl' from data source
  `/home/runner/work/_temp/Library/drmr/maps/sum_fl.shp' using driver `ESRI Shapefile'
Simple feature collection with 10 features and 3 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: -75.77033 ymin: 35.18407 xmax: -65.67583 ymax: 44.4013
Geodetic CRS:  WGS 84
Path [1] :Initial log joint density = -56611.595499
Exception: gamma_lpdf: Inverse scale parameter[4] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)
Exception: gamma_lpdf: Inverse scale parameter[7] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)
Error evaluating model log probability: Non-finite gradient.
Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
             99      -3.801e+02      8.830e-02   8.489e+01    2.286e+00  2.286e-01      2476 -4.483e+02 -4.483e+02
Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            199      -3.656e+02      2.337e-02   1.050e+01    1.135e+00  1.135e-01      4976 -4.138e+02 -4.138e+02
Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            299      -3.600e+02      1.403e-01   1.329e+01    1.000e+00  1.000e+00      7476 -3.991e+02 -3.991e+02
Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            399      -3.585e+02      2.401e-03   7.864e+00    1.000e+00  1.000e+00      9976 -4.074e+02 -4.074e+02
Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            499      -3.578e+02      3.412e-02   6.732e+00    1.000e+00  1.000e+00     12476 -3.962e+02 -3.962e+02
Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            599      -3.574e+02      2.391e-03   2.649e+00    4.130e-01  4.130e-01     14976 -4.306e+02 -4.306e+02
Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            699      -3.573e+02      6.740e-03   2.328e+00    1.000e+00  1.000e+00     17476 -4.067e+02 -4.067e+02
Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            799      -3.572e+02      3.414e-04   1.016e+00    1.000e+00  1.000e+00     19976 -4.224e+02 -4.224e+02
Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            899      -3.572e+02      2.235e-03   2.928e-01    1.000e+00  1.000e+00     22476 -4.055e+02 -4.055e+02
Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            971      -3.572e+02      4.176e-04   1.003e-01    1.000e+00  1.000e+00     24276 -4.096e+02 -4.096e+02
Path [1] :Best Iter: [687] ELBO (-373.411206) evaluations: (24276)
Rejecting initial value:
  Log probability evaluates to log(0), i.e. negative infinity.
  Stan can't start sampling from this initial value.
Path [2] :Initial log joint density = -1915.197254
Exception: gamma_lpdf: Inverse scale parameter[6] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)
Path [2] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
             99      -3.850e+02      4.128e-02   8.825e+01    1.000e+00  1.000e+00      2476 -4.380e+02 -4.380e+02
Path [2] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            199      -3.647e+02      9.455e-02   4.344e+01    1.000e+00  1.000e+00      4976 -3.946e+02 -3.946e+02
Path [2] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            299      -3.609e+02      1.538e-01   1.202e+02    1.000e+00  1.000e+00      7476 -3.967e+02 -3.967e+02
Path [2] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            399      -3.581e+02      3.576e-03   9.015e+00    1.000e+00  1.000e+00      9976 -4.126e+02 -4.126e+02
Path [2] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            499      -3.577e+02      1.588e-02   4.587e+00    1.000e+00  1.000e+00     12476 -3.989e+02 -3.989e+02
Path [2] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            599      -3.574e+02      3.539e-02   2.990e+00    1.000e+00  1.000e+00     14976 -4.065e+02 -4.065e+02
Path [2] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            699      -3.574e+02      1.603e-03   1.549e+00    1.000e+00  1.000e+00     17476 -4.095e+02 -4.095e+02
Path [2] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            799      -3.573e+02      1.312e-03   1.037e+00    9.526e-01  9.526e-01     19976 -4.066e+02 -4.066e+02
Path [2] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            899      -3.572e+02      8.456e-03   1.529e+00    2.374e-01  1.000e+00     22476 -4.383e+02 -4.383e+02
Path [2] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            999      -3.572e+02      1.416e-04   2.048e-01    1.000e+00  1.000e+00     24976 -4.060e+02 -4.060e+02
Path [2] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
           1000      -3.572e+02      2.500e-04   3.956e-01    1.000e+00  1.000e+00     25001 -3.877e+02 -3.877e+02
Path [2] :Best Iter: [402] ELBO (-375.318977) evaluations: (25001)
Path [3] :Initial log joint density = -321520324.575742
Path [3] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
              1      -3.215e+08      0.000e+00   9.706e+09    1.000e-03  1.000e-03         1        nan       -inf
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Inverse scale parameter[2] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)
Exception: gamma_lpdf: Inverse scale parameter[2] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)
Path [4] :Initial log joint density = -159351990537762373632.000000
Path [4] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
              1      -1.594e+20      0.000e+00   6.418e+21    1.000e-03  1.000e-03         1        nan       -inf
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Total log probability function evaluations:51227 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Optimization terminated with error: Line search failed to achieve a sufficient decrease, no more progress can be made Optimization failed to start, pathfinder cannot be run.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Pathfinder iteration: 2 failed.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Optimization terminated with error: Line search failed to achieve a sufficient decrease, no more progress can be made Optimization failed to start, pathfinder cannot be run.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Pathfinder iteration: 3 failed.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Finished in  5.5 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Pareto k-hat = 2.32. Mean does not exist, making empirical mean estimate of the draws not applicable.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Init values were only set for a subset of parameters.
Missing init values for the following parameters:
 - chain 1: sigma_obs
 - chain 2: sigma_obs
 - chain 3: sigma_obs
 - chain 4: sigma_obs

To disable this message use options(cmdstanr_warn_inits = FALSE).</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Running MCMC with 4 parallel chains...

Chain 1 Iteration:    1 / 2000 [  0%]  (Warmup) </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Exception: gamma_lpdf: Inverse scale parameter[2] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Exception: gamma_lpdf: Inverse scale parameter[2] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Exception: gamma_lpdf: Inverse scale parameter[2] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Exception: gamma_lpdf: Inverse scale parameter[2] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Chain 2 Iteration:    1 / 2000 [  0%]  (Warmup) </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Exception: gamma_lpdf: Inverse scale parameter[2] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Exception: gamma_lpdf: Inverse scale parameter[2] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Exception: gamma_lpdf: Inverse scale parameter[2] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Chain 3 Iteration:    1 / 2000 [  0%]  (Warmup) </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Exception: gamma_lpdf: Inverse scale parameter[2] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Exception: gamma_lpdf: Inverse scale parameter[2] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Exception: gamma_lpdf: Inverse scale parameter[6] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Chain 4 Iteration:    1 / 2000 [  0%]  (Warmup) </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Exception: gamma_lpdf: Inverse scale parameter[3] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Exception: gamma_lpdf: Inverse scale parameter[3] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Exception: gamma_lpdf: Inverse scale parameter[1] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Exception: gamma_lpdf: Inverse scale parameter[2] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Exception: gamma_lpdf: Random variable is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Exception: gamma_lpdf: Inverse scale parameter[1] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Exception: gamma_lpdf: Inverse scale parameter[2] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Chain 1 Iteration:  100 / 2000 [  5%]  (Warmup)
Chain 2 Iteration:  100 / 2000 [  5%]  (Warmup)
Chain 3 Iteration:  100 / 2000 [  5%]  (Warmup)
Chain 4 Iteration:  100 / 2000 [  5%]  (Warmup)
Chain 1 Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 2 Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 3 Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 4 Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 1 Iteration:  300 / 2000 [ 15%]  (Warmup)
Chain 4 Iteration:  300 / 2000 [ 15%]  (Warmup)
Chain 2 Iteration:  300 / 2000 [ 15%]  (Warmup)
Chain 3 Iteration:  300 / 2000 [ 15%]  (Warmup)
Chain 1 Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 4 Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 3 Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 2 Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 1 Iteration:  500 / 2000 [ 25%]  (Warmup)
Chain 4 Iteration:  500 / 2000 [ 25%]  (Warmup)
Chain 3 Iteration:  500 / 2000 [ 25%]  (Warmup)
Chain 2 Iteration:  500 / 2000 [ 25%]  (Warmup)
Chain 1 Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 4 Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 3 Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 2 Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 1 Iteration:  700 / 2000 [ 35%]  (Warmup)
Chain 3 Iteration:  700 / 2000 [ 35%]  (Warmup)
Chain 4 Iteration:  700 / 2000 [ 35%]  (Warmup)
Chain 2 Iteration:  700 / 2000 [ 35%]  (Warmup)
Chain 1 Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 3 Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 4 Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 2 Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 1 Iteration:  900 / 2000 [ 45%]  (Warmup)
Chain 3 Iteration:  900 / 2000 [ 45%]  (Warmup)
Chain 4 Iteration:  900 / 2000 [ 45%]  (Warmup)
Chain 2 Iteration:  900 / 2000 [ 45%]  (Warmup)
Chain 1 Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 1 Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 3 Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 3 Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 4 Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 4 Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 2 Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 2 Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 1 Iteration: 1100 / 2000 [ 55%]  (Sampling)
Chain 3 Iteration: 1100 / 2000 [ 55%]  (Sampling)
Chain 4 Iteration: 1100 / 2000 [ 55%]  (Sampling)
Chain 2 Iteration: 1100 / 2000 [ 55%]  (Sampling)
Chain 1 Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 3 Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 4 Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 2 Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 1 Iteration: 1300 / 2000 [ 65%]  (Sampling)
Chain 3 Iteration: 1300 / 2000 [ 65%]  (Sampling)
Chain 4 Iteration: 1300 / 2000 [ 65%]  (Sampling)
Chain 2 Iteration: 1300 / 2000 [ 65%]  (Sampling)
Chain 1 Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 3 Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 4 Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 2 Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 1 Iteration: 1500 / 2000 [ 75%]  (Sampling)
Chain 3 Iteration: 1500 / 2000 [ 75%]  (Sampling)
Chain 4 Iteration: 1500 / 2000 [ 75%]  (Sampling)
Chain 2 Iteration: 1500 / 2000 [ 75%]  (Sampling)
Chain 1 Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 3 Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 4 Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 2 Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 1 Iteration: 1700 / 2000 [ 85%]  (Sampling)
Chain 3 Iteration: 1700 / 2000 [ 85%]  (Sampling)
Chain 4 Iteration: 1700 / 2000 [ 85%]  (Sampling)
Chain 2 Iteration: 1700 / 2000 [ 85%]  (Sampling)
Chain 1 Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 3 Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 4 Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 2 Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 1 Iteration: 1900 / 2000 [ 95%]  (Sampling)
Chain 3 Iteration: 1900 / 2000 [ 95%]  (Sampling)
Chain 4 Iteration: 1900 / 2000 [ 95%]  (Sampling)
Chain 2 Iteration: 1900 / 2000 [ 95%]  (Sampling)
Chain 1 Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 1 finished in 59.3 seconds.
Chain 3 Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 3 finished in 59.4 seconds.
Chain 4 Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 4 finished in 59.6 seconds.
Chain 2 Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 2 finished in 59.7 seconds.

All 4 chains finished successfully.
Mean chain execution time: 59.5 seconds.
Total execution time: 59.8 seconds.

Path [1] :Initial log joint density = -43427.364023
Exception: gamma_lpdf: Inverse scale parameter[4] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)
Error evaluating model log probability: Non-finite gradient.
Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
             99      -3.830e+02      9.344e-01   2.422e+02    1.000e+00  1.000e+00      2476 -4.254e+02 -4.254e+02
Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            199      -3.629e+02      1.180e-02   2.712e+01    3.707e-01  3.707e-01      4976 -3.974e+02 -3.974e+02
Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            299      -3.577e+02      6.180e-02   3.650e+01    2.883e-01  1.000e+00      7476 -4.087e+02 -4.087e+02
Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            399      -3.565e+02      2.213e-02   3.384e+01    1.000e+00  1.000e+00      9976 -4.096e+02 -4.096e+02
Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            499      -3.560e+02      5.610e-04   3.921e+00    6.144e-01  6.144e-01     12476 -4.280e+02 -4.280e+02
Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            599      -3.558e+02      3.089e-03   3.212e+00    1.000e+00  1.000e+00     14976 -4.326e+02 -4.326e+02
Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            699      -3.557e+02      2.106e-03   2.340e+00    1.000e+00  1.000e+00     17476 -3.847e+02 -3.847e+02
Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            799      -3.556e+02      8.028e-03   1.624e+00    1.000e+00  1.000e+00     19976 -3.986e+02 -3.986e+02
Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            899      -3.556e+02      2.698e-04   2.700e-01    1.000e+00  1.000e+00     22476 -4.114e+02 -4.114e+02
Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            999      -3.556e+02      1.276e-03   7.036e-01    1.000e+00  1.000e+00     24976 -3.949e+02 -3.949e+02
Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
           1000      -3.556e+02      4.039e-03   1.599e+00    1.000e+00  1.000e+00     25001 -3.968e+02 -3.968e+02
Path [1] :Best Iter: [265] ELBO (-374.271911) evaluations: (25001)
Rejecting initial value:
  Log probability evaluates to log(0), i.e. negative infinity.
  Stan can't start sampling from this initial value.
Rejecting initial value:
  Log probability evaluates to log(0), i.e. negative infinity.
  Stan can't start sampling from this initial value.
Path [2] :Initial log joint density = -8125316681626496417136640.000000
Path [2] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
              1      -8.125e+24      0.000e+00   2.663e+26    1.000e-03  1.000e-03         1        nan       -inf
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Path [3] :Initial log joint density = -1005369569.086192
Path [3] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
              1      -1.005e+09      0.000e+00   3.115e+10    1.000e-03  1.000e-03         1        nan       -inf
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Path [4] :Initial log joint density = -330822343709969088512.000000
Path [4] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
              1      -3.308e+20      0.000e+00   1.209e+22    1.000e-03  1.000e-03         1        nan       -inf
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Total log probability function evaluations:25976 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Optimization terminated with error: Line search failed to achieve a sufficient decrease, no more progress can be made Optimization failed to start, pathfinder cannot be run.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Pathfinder iteration: 1 failed.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Optimization terminated with error: Line search failed to achieve a sufficient decrease, no more progress can be made Optimization failed to start, pathfinder cannot be run.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Pathfinder iteration: 2 failed.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Optimization terminated with error: Line search failed to achieve a sufficient decrease, no more progress can be made Optimization failed to start, pathfinder cannot be run.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Pathfinder iteration: 3 failed.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Finished in  2.2 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Pareto k-hat = 2.08. Mean does not exist, making empirical mean estimate of the draws not applicable.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Init values were only set for a subset of parameters.
Missing init values for the following parameters:
 - chain 1: sigma_obs, zeta
 - chain 2: sigma_obs, zeta
 - chain 3: sigma_obs, zeta
 - chain 4: sigma_obs, zeta

To disable this message use options(cmdstanr_warn_inits = FALSE).</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Running MCMC with 4 parallel chains...

Chain 1 Iteration:    1 / 2000 [  0%]  (Warmup) </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Exception: gamma_lpdf: Inverse scale parameter[2] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Exception: gamma_lpdf: Inverse scale parameter[2] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Exception: gamma_lpdf: Inverse scale parameter[2] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Exception: gamma_lpdf: Inverse scale parameter[2] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Chain 2 Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 3 Iteration:    1 / 2000 [  0%]  (Warmup) </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Exception: gamma_lpdf: Inverse scale parameter[4] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Exception: gamma_lpdf: Inverse scale parameter[4] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Exception: gamma_lpdf: Inverse scale parameter[6] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Chain 4 Iteration:    1 / 2000 [  0%]  (Warmup) </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Exception: gamma_lpdf: Inverse scale parameter[2] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Exception: gamma_lpdf: Inverse scale parameter[2] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Exception: gamma_lpdf: Inverse scale parameter[2] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Exception: gamma_lpdf: Inverse scale parameter[1] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Exception: gamma_lpdf: Inverse scale parameter[3] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Exception: gamma_lpdf: Inverse scale parameter[3] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Exception: gamma_lpdf: Inverse scale parameter[1] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Exception: gamma_lpdf: Inverse scale parameter[2] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Exception: gamma_lpdf: Inverse scale parameter[1] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Exception: gamma_lpdf: Inverse scale parameter[3] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Chain 3 Iteration:  100 / 2000 [  5%]  (Warmup)
Chain 1 Iteration:  100 / 2000 [  5%]  (Warmup)
Chain 4 Iteration:  100 / 2000 [  5%]  (Warmup)
Chain 2 Iteration:  100 / 2000 [  5%]  (Warmup)
Chain 3 Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 1 Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 4 Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 2 Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 3 Iteration:  300 / 2000 [ 15%]  (Warmup)
Chain 4 Iteration:  300 / 2000 [ 15%]  (Warmup)
Chain 1 Iteration:  300 / 2000 [ 15%]  (Warmup)
Chain 2 Iteration:  300 / 2000 [ 15%]  (Warmup)
Chain 3 Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 1 Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 4 Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 2 Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 3 Iteration:  500 / 2000 [ 25%]  (Warmup)
Chain 1 Iteration:  500 / 2000 [ 25%]  (Warmup)
Chain 4 Iteration:  500 / 2000 [ 25%]  (Warmup)
Chain 2 Iteration:  500 / 2000 [ 25%]  (Warmup)
Chain 3 Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 4 Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 1 Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 3 Iteration:  700 / 2000 [ 35%]  (Warmup)
Chain 2 Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 4 Iteration:  700 / 2000 [ 35%]  (Warmup)
Chain 1 Iteration:  700 / 2000 [ 35%]  (Warmup)
Chain 3 Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 2 Iteration:  700 / 2000 [ 35%]  (Warmup)
Chain 4 Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 1 Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 3 Iteration:  900 / 2000 [ 45%]  (Warmup)
Chain 2 Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 4 Iteration:  900 / 2000 [ 45%]  (Warmup)
Chain 1 Iteration:  900 / 2000 [ 45%]  (Warmup)
Chain 3 Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 3 Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 2 Iteration:  900 / 2000 [ 45%]  (Warmup)
Chain 4 Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 4 Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 3 Iteration: 1100 / 2000 [ 55%]  (Sampling)
Chain 1 Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 1 Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 2 Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 2 Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 3 Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 4 Iteration: 1100 / 2000 [ 55%]  (Sampling)
Chain 1 Iteration: 1100 / 2000 [ 55%]  (Sampling)
Chain 2 Iteration: 1100 / 2000 [ 55%]  (Sampling)
Chain 3 Iteration: 1300 / 2000 [ 65%]  (Sampling)
Chain 4 Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 1 Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 2 Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 3 Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 4 Iteration: 1300 / 2000 [ 65%]  (Sampling)
Chain 1 Iteration: 1300 / 2000 [ 65%]  (Sampling)
Chain 3 Iteration: 1500 / 2000 [ 75%]  (Sampling)
Chain 2 Iteration: 1300 / 2000 [ 65%]  (Sampling)
Chain 4 Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 1 Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 3 Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 2 Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 4 Iteration: 1500 / 2000 [ 75%]  (Sampling)
Chain 3 Iteration: 1700 / 2000 [ 85%]  (Sampling)
Chain 1 Iteration: 1500 / 2000 [ 75%]  (Sampling)
Chain 2 Iteration: 1500 / 2000 [ 75%]  (Sampling)
Chain 3 Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 4 Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 1 Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 3 Iteration: 1900 / 2000 [ 95%]  (Sampling)
Chain 2 Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 4 Iteration: 1700 / 2000 [ 85%]  (Sampling)
Chain 1 Iteration: 1700 / 2000 [ 85%]  (Sampling)
Chain 3 Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 3 finished in 35.8 seconds.
Chain 2 Iteration: 1700 / 2000 [ 85%]  (Sampling)
Chain 4 Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 1 Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 4 Iteration: 1900 / 2000 [ 95%]  (Sampling)
Chain 2 Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 1 Iteration: 1900 / 2000 [ 95%]  (Sampling)
Chain 4 Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 4 finished in 37.7 seconds.
Chain 1 Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 2 Iteration: 1900 / 2000 [ 95%]  (Sampling)
Chain 1 finished in 38.4 seconds.
Chain 2 Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 2 finished in 39.0 seconds.

All 4 chains finished successfully.
Mean chain execution time: 37.7 seconds.
Total execution time: 39.1 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 3 of 4000 (0.0%) transitions ended with a divergence.
See https://mc-stan.org/misc/warnings for details.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Path [1] :Initial log joint density = -52118.730867
Exception: gamma_lpdf: Inverse scale parameter[12] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)
Error evaluating model log probability: Non-finite gradient.
Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
             99      -3.959e+02      1.319e-01   1.114e+02    2.125e-01  1.000e+00      2476 -4.723e+02 -4.723e+02
Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            199      -3.776e+02      4.660e-03   1.197e+01    1.000e+00  1.000e+00      4976 -4.440e+02 -4.440e+02
Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            299      -3.747e+02      1.759e-03   2.467e+00    1.000e+00  1.000e+00      7476 -4.407e+02 -4.407e+02
Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            399      -3.744e+02      1.679e-02   1.094e+01    1.000e+00  1.000e+00      9976 -3.908e+02 -3.908e+02
Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            499      -3.743e+02      3.658e-02   3.823e+00    1.000e+00  1.000e+00     12476 -3.997e+02 -3.997e+02
Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            599      -3.742e+02      9.980e-03   1.791e+00    1.000e+00  1.000e+00     14976 -4.167e+02 -4.167e+02
Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            699      -3.742e+02      2.467e-04   1.842e+00    2.831e-01  2.831e-01     17476 -4.237e+02 -4.237e+02
Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            799      -3.742e+02      8.908e-04   3.621e-01    6.504e-01  6.504e-01     19976 -4.300e+02 -4.300e+02
Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            878      -3.742e+02      1.862e-04   1.081e-01    1.000e+00  1.000e+00     21951 -3.939e+02 -3.939e+02
Path [1] :Best Iter: [577] ELBO (-381.112906) evaluations: (21951)
Rejecting initial value:
  Log probability evaluates to log(0), i.e. negative infinity.
  Stan can't start sampling from this initial value.
Rejecting initial value:
  Log probability evaluates to log(0), i.e. negative infinity.
  Stan can't start sampling from this initial value.
Rejecting initial value:
  Log probability evaluates to log(0), i.e. negative infinity.
  Stan can't start sampling from this initial value.
Path [2] :Initial log joint density = -20582.478493
Error evaluating model log probability: Non-finite gradient.
Path [2] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
             99      -3.884e+02      1.346e-01   3.610e+01    1.000e+00  1.000e+00      2476 -4.510e+02 -4.510e+02
Path [2] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            199      -3.769e+02      5.420e-02   6.422e+01    1.000e+00  1.000e+00      4976 -4.224e+02 -4.224e+02
Path [2] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            299      -3.752e+02      6.663e-03   1.108e+01    4.656e-01  1.000e+00      7476 -4.252e+02 -4.252e+02
Path [2] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            399      -3.743e+02      4.254e-03   5.525e+00    1.000e+00  1.000e+00      9976 -4.283e+02 -4.283e+02
Path [2] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            499      -3.742e+02      1.607e-03   5.631e-01    1.000e+00  1.000e+00     12476 -4.160e+02 -4.160e+02
Path [2] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            599      -3.742e+02      5.404e-04   9.575e-01    1.000e+00  1.000e+00     14976 -4.248e+02 -4.248e+02
Path [2] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            669      -3.742e+02      9.951e-05   9.234e-02    5.194e-01  1.000e+00     16726 -4.332e+02 -4.332e+02
Path [2] :Best Iter: [648] ELBO (-384.853040) evaluations: (16726)
Path [3] :Initial log joint density = -5583089347.055940
Path [3] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
              1      -5.583e+09      0.000e+00   1.833e+11    1.000e-03  1.000e-03         1        nan       -inf
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Path [4] :Initial log joint density = -3305889083640.902832
Path [4] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
              1      -3.306e+12      0.000e+00   1.022e+14    1.000e-03  1.000e-03         1        nan       -inf
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)
Total log probability function evaluations:40627 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Optimization terminated with error: Line search failed to achieve a sufficient decrease, no more progress can be made Optimization failed to start, pathfinder cannot be run.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Pathfinder iteration: 2 failed.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Optimization terminated with error: Line search failed to achieve a sufficient decrease, no more progress can be made Optimization failed to start, pathfinder cannot be run.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Pathfinder iteration: 3 failed.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Finished in  6.7 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Pareto k-hat = 2.49. Mean does not exist, making empirical mean estimate of the draws not applicable.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Init values were only set for a subset of parameters.
Missing init values for the following parameters:
 - chain 1: sigma_obs, zeta
 - chain 2: sigma_obs, zeta
 - chain 3: sigma_obs, zeta
 - chain 4: sigma_obs, zeta

To disable this message use options(cmdstanr_warn_inits = FALSE).</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Running MCMC with 4 parallel chains...

Chain 1 Iteration:    1 / 2000 [  0%]  (Warmup) </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Exception: gamma_lpdf: Inverse scale parameter[12] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Exception: gamma_lpdf: Inverse scale parameter[12] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Chain 2 Iteration:    1 / 2000 [  0%]  (Warmup) </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Exception: gamma_lpdf: Inverse scale parameter[2] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Exception: gamma_lpdf: Inverse scale parameter[2] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Exception: gamma_lpdf: Inverse scale parameter[2] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Exception: gamma_lpdf: Inverse scale parameter[2] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Chain 3 Iteration:    1 / 2000 [  0%]  (Warmup) </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Exception: gamma_lpdf: Inverse scale parameter[10] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Exception: gamma_lpdf: Inverse scale parameter[10] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Exception: gamma_lpdf: Inverse scale parameter[12] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Exception: gamma_lpdf: Inverse scale parameter[6] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Chain 4 Iteration:    1 / 2000 [  0%]  (Warmup) </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Exception: gamma_lpdf: Inverse scale parameter[12] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Exception: gamma_lpdf: Inverse scale parameter[12] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Exception: gamma_lpdf: Inverse scale parameter[1] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Exception: gamma_lpdf: Inverse scale parameter[2] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Exception: gamma_lpdf: Random variable is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Exception: gamma_lpdf: Inverse scale parameter[10] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Exception: gamma_lpdf: Random variable is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Exception: gamma_lpdf: Inverse scale parameter[10] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Chain 1 Iteration:  100 / 2000 [  5%]  (Warmup)
Chain 3 Iteration:  100 / 2000 [  5%]  (Warmup)
Chain 2 Iteration:  100 / 2000 [  5%]  (Warmup)
Chain 4 Iteration:  100 / 2000 [  5%]  (Warmup)
Chain 1 Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 3 Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 2 Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 2 Iteration:  300 / 2000 [ 15%]  (Warmup)
Chain 3 Iteration:  300 / 2000 [ 15%]  (Warmup)
Chain 4 Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 1 Iteration:  300 / 2000 [ 15%]  (Warmup)
Chain 2 Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 1 Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 3 Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 4 Iteration:  300 / 2000 [ 15%]  (Warmup)
Chain 2 Iteration:  500 / 2000 [ 25%]  (Warmup)
Chain 1 Iteration:  500 / 2000 [ 25%]  (Warmup)
Chain 3 Iteration:  500 / 2000 [ 25%]  (Warmup)
Chain 4 Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 1 Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 2 Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 3 Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 4 Iteration:  500 / 2000 [ 25%]  (Warmup)
Chain 1 Iteration:  700 / 2000 [ 35%]  (Warmup)
Chain 2 Iteration:  700 / 2000 [ 35%]  (Warmup)
Chain 3 Iteration:  700 / 2000 [ 35%]  (Warmup)
Chain 1 Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 4 Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 2 Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 3 Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 1 Iteration:  900 / 2000 [ 45%]  (Warmup)
Chain 4 Iteration:  700 / 2000 [ 35%]  (Warmup)
Chain 2 Iteration:  900 / 2000 [ 45%]  (Warmup)
Chain 3 Iteration:  900 / 2000 [ 45%]  (Warmup)
Chain 4 Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 1 Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 1 Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 2 Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 2 Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 3 Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 3 Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 4 Iteration:  900 / 2000 [ 45%]  (Warmup)
Chain 1 Iteration: 1100 / 2000 [ 55%]  (Sampling)
Chain 2 Iteration: 1100 / 2000 [ 55%]  (Sampling)
Chain 1 Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 4 Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 4 Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 3 Iteration: 1100 / 2000 [ 55%]  (Sampling)
Chain 1 Iteration: 1300 / 2000 [ 65%]  (Sampling)
Chain 2 Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 4 Iteration: 1100 / 2000 [ 55%]  (Sampling)
Chain 1 Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 3 Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 2 Iteration: 1300 / 2000 [ 65%]  (Sampling)
Chain 1 Iteration: 1500 / 2000 [ 75%]  (Sampling)
Chain 4 Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 2 Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 3 Iteration: 1300 / 2000 [ 65%]  (Sampling)
Chain 1 Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 1 Iteration: 1700 / 2000 [ 85%]  (Sampling)
Chain 2 Iteration: 1500 / 2000 [ 75%]  (Sampling)
Chain 4 Iteration: 1300 / 2000 [ 65%]  (Sampling)
Chain 3 Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 1 Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 2 Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 4 Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 1 Iteration: 1900 / 2000 [ 95%]  (Sampling)
Chain 3 Iteration: 1500 / 2000 [ 75%]  (Sampling)
Chain 2 Iteration: 1700 / 2000 [ 85%]  (Sampling)
Chain 1 Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 1 finished in 72.0 seconds.
Chain 4 Iteration: 1500 / 2000 [ 75%]  (Sampling)
Chain 3 Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 2 Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 4 Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 4 Iteration: 1700 / 2000 [ 85%]  (Sampling)
Chain 3 Iteration: 1700 / 2000 [ 85%]  (Sampling)
Chain 2 Iteration: 1900 / 2000 [ 95%]  (Sampling)
Chain 4 Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 3 Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 4 Iteration: 1900 / 2000 [ 95%]  (Sampling)
Chain 2 Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 2 finished in 78.8 seconds.
Chain 4 Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 4 finished in 80.2 seconds.
Chain 3 Iteration: 1900 / 2000 [ 95%]  (Sampling)
Chain 3 Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 3 finished in 82.0 seconds.

All 4 chains finished successfully.
Mean chain execution time: 78.3 seconds.
Total execution time: 82.1 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 1 of 4000 (0.0%) transitions ended with a divergence.
See https://mc-stan.org/misc/warnings for details.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Rejecting initial value:
  Log probability evaluates to log(0), i.e. negative infinity.
  Stan can't start sampling from this initial value.
Rejecting initial value:
  Log probability evaluates to log(0), i.e. negative infinity.
  Stan can't start sampling from this initial value.
Path [1] :Initial log joint density = -200690.060417
Exception: gamma_lpdf: Inverse scale parameter[2] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)
Exception: gamma_lpdf: Inverse scale parameter[2] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)
Exception: gamma_lpdf: Inverse scale parameter[5] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)
Exception: gamma_lpdf: Inverse scale parameter[10] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)
Error evaluating model log probability: Non-finite gradient.
Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
             99      -3.661e+02      1.017e-01   6.466e+00    1.000e+00  1.000e+00      2476 -3.976e+02 -3.976e+02
Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            199      -3.588e+02      5.657e-02   9.028e+00    7.657e-01  7.657e-01      4976 -3.988e+02 -3.988e+02
Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            299      -3.510e+02      4.197e-03   1.578e+00    1.000e+00  1.000e+00      7476 -4.021e+02 -4.021e+02
Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            399      -3.509e+02      7.271e-04   1.172e-01    9.842e-01  9.842e-01      9976 -3.981e+02 -3.981e+02
Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            451      -3.509e+02      1.568e-04   3.127e-02    1.000e+00  1.000e+00     11276 -3.979e+02 -3.979e+02
Path [1] :Best Iter: [372] ELBO (-370.175024) evaluations: (11276)
Rejecting initial value:
  Log probability evaluates to log(0), i.e. negative infinity.
  Stan can't start sampling from this initial value.
Path [2] :Initial log joint density = -1904.656003
Error evaluating model log probability: Non-finite gradient.
Path [2] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
             99      -3.518e+02      1.983e-01   1.373e+01    1.000e+00  1.000e+00      2476 -4.026e+02 -4.026e+02
Path [2] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            199      -3.510e+02      1.690e-02   1.710e+00    1.000e+00  1.000e+00      4976 -3.949e+02 -3.949e+02
Path [2] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            299      -3.509e+02      1.217e-03   1.646e-01    8.978e-01  8.978e-01      7476 -3.936e+02 -3.936e+02
Path [2] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            329      -3.509e+02      8.951e-05   1.993e-02    1.000e+00  1.000e+00      8226 -3.969e+02 -3.969e+02
Path [2] :Best Iter: [320] ELBO (-374.686831) evaluations: (8226)
Path [3] :Initial log joint density = -1537.656836
Error evaluating model log probability: Non-finite gradient.
Path [3] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
             99      -3.518e+02      7.684e-02   2.408e+01    1.000e+00  1.000e+00      2476 -3.973e+02 -3.973e+02
Path [3] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            199      -3.509e+02      2.996e-03   1.726e+00    1.589e-01  1.000e+00      4976 -4.012e+02 -4.012e+02
Path [3] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            299      -3.509e+02      3.941e-04   1.654e-01    4.556e-01  1.000e+00      7476 -3.989e+02 -3.989e+02
Path [3] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            340      -3.509e+02      3.752e-04   3.329e-02    1.000e+00  1.000e+00      8501 -3.778e+02 -3.778e+02
Path [3] :Best Iter: [90] ELBO (-371.682286) evaluations: (8501)
Rejecting initial value:
  Log probability evaluates to log(0), i.e. negative infinity.
  Stan can't start sampling from this initial value.
Path [4] :Initial log joint density = -3088.453733
Path [4] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
             99      -3.516e+02      2.746e-02   2.760e+00    1.000e+00  1.000e+00      2476 -3.899e+02 -3.899e+02
Path [4] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            199      -3.509e+02      5.160e-03   9.043e-01    1.000e+00  1.000e+00      4976 -3.832e+02 -3.832e+02
Path [4] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            299      -3.509e+02      3.420e-04   4.875e-02    1.000e+00  1.000e+00      7476 -3.994e+02 -3.994e+02
Path [4] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            317      -3.509e+02      6.405e-05   4.025e-02    1.000e+00  1.000e+00      7926 -4.088e+02 -4.088e+02
Path [4] :Best Iter: [279] ELBO (-370.006251) evaluations: (7926)
Total log probability function evaluations:39829
Finished in  3.6 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Pareto k-hat = 2.87. Mean does not exist, making empirical mean estimate of the draws not applicable.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Init values were only set for a subset of parameters.
Missing init values for the following parameters:
 - chain 1: sigma_obs, zeta
 - chain 2: sigma_obs, zeta
 - chain 3: sigma_obs, zeta
 - chain 4: sigma_obs, zeta

To disable this message use options(cmdstanr_warn_inits = FALSE).</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Running MCMC with 4 parallel chains...

Chain 1 Iteration:    1 / 2000 [  0%]  (Warmup) </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Exception: gamma_lpdf: Random variable is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Exception: gamma_lpdf: Inverse scale parameter[2] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Chain 2 Iteration:    1 / 2000 [  0%]  (Warmup) </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Exception: gamma_lpdf: Inverse scale parameter[3] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Exception: gamma_lpdf: Inverse scale parameter[3] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Exception: gamma_lpdf: Inverse scale parameter[1] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Exception: gamma_lpdf: Inverse scale parameter[5] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Chain 3 Iteration:    1 / 2000 [  0%]  (Warmup) </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Exception: gamma_lpdf: Inverse scale parameter[5] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Exception: gamma_lpdf: Inverse scale parameter[5] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 422, column 4 to column 54)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Exception: gamma_lpdf: Inverse scale parameter[1] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Chain 4 Iteration:    1 / 2000 [  0%]  (Warmup) </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Exception: gamma_lpdf: Inverse scale parameter[2] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Exception: gamma_lpdf: Inverse scale parameter[2] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Exception: gamma_lpdf: Inverse scale parameter[1] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Exception: gamma_lpdf: Inverse scale parameter[2] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f2ef2795e.stan', line 443, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Chain 1 Iteration:  100 / 2000 [  5%]  (Warmup)
Chain 2 Iteration:  100 / 2000 [  5%]  (Warmup)
Chain 3 Iteration:  100 / 2000 [  5%]  (Warmup)
Chain 4 Iteration:  100 / 2000 [  5%]  (Warmup)
Chain 1 Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 2 Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 3 Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 4 Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 1 Iteration:  300 / 2000 [ 15%]  (Warmup)
Chain 3 Iteration:  300 / 2000 [ 15%]  (Warmup)
Chain 2 Iteration:  300 / 2000 [ 15%]  (Warmup)
Chain 3 Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 4 Iteration:  300 / 2000 [ 15%]  (Warmup)
Chain 1 Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 2 Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 3 Iteration:  500 / 2000 [ 25%]  (Warmup)
Chain 4 Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 2 Iteration:  500 / 2000 [ 25%]  (Warmup)
Chain 1 Iteration:  500 / 2000 [ 25%]  (Warmup)
Chain 4 Iteration:  500 / 2000 [ 25%]  (Warmup)
Chain 3 Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 1 Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 2 Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 4 Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 3 Iteration:  700 / 2000 [ 35%]  (Warmup)
Chain 1 Iteration:  700 / 2000 [ 35%]  (Warmup)
Chain 2 Iteration:  700 / 2000 [ 35%]  (Warmup)
Chain 4 Iteration:  700 / 2000 [ 35%]  (Warmup)
Chain 3 Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 1 Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 2 Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 4 Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 1 Iteration:  900 / 2000 [ 45%]  (Warmup)
Chain 3 Iteration:  900 / 2000 [ 45%]  (Warmup)
Chain 2 Iteration:  900 / 2000 [ 45%]  (Warmup)
Chain 4 Iteration:  900 / 2000 [ 45%]  (Warmup)
Chain 1 Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 1 Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 2 Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 2 Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 1 Iteration: 1100 / 2000 [ 55%]  (Sampling)
Chain 3 Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 3 Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 1 Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 4 Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 4 Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 1 Iteration: 1300 / 2000 [ 65%]  (Sampling)
Chain 2 Iteration: 1100 / 2000 [ 55%]  (Sampling)
Chain 3 Iteration: 1100 / 2000 [ 55%]  (Sampling)
Chain 1 Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 4 Iteration: 1100 / 2000 [ 55%]  (Sampling)
Chain 1 Iteration: 1500 / 2000 [ 75%]  (Sampling)
Chain 1 Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 2 Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 1 Iteration: 1700 / 2000 [ 85%]  (Sampling)
Chain 3 Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 1 Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 1 Iteration: 1900 / 2000 [ 95%]  (Sampling)
Chain 4 Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 2 Iteration: 1300 / 2000 [ 65%]  (Sampling)
Chain 3 Iteration: 1300 / 2000 [ 65%]  (Sampling)
Chain 1 Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 1 finished in 30.2 seconds.
Chain 2 Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 4 Iteration: 1300 / 2000 [ 65%]  (Sampling)
Chain 3 Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 2 Iteration: 1500 / 2000 [ 75%]  (Sampling)
Chain 2 Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 3 Iteration: 1500 / 2000 [ 75%]  (Sampling)
Chain 4 Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 2 Iteration: 1700 / 2000 [ 85%]  (Sampling)
Chain 3 Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 4 Iteration: 1500 / 2000 [ 75%]  (Sampling)
Chain 2 Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 2 Iteration: 1900 / 2000 [ 95%]  (Sampling)
Chain 3 Iteration: 1700 / 2000 [ 85%]  (Sampling)
Chain 4 Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 2 Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 2 finished in 36.3 seconds.
Chain 3 Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 4 Iteration: 1700 / 2000 [ 85%]  (Sampling)
Chain 3 Iteration: 1900 / 2000 [ 95%]  (Sampling)
Chain 3 Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 3 finished in 37.7 seconds.
Chain 4 Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 4 Iteration: 1900 / 2000 [ 95%]  (Sampling)
Chain 4 Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 4 finished in 39.5 seconds.

All 4 chains finished successfully.
Mean chain execution time: 35.9 seconds.
Total execution time: 39.6 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 293 of 4000 (7.0%) transitions ended with a divergence.
See https://mc-stan.org/misc/warnings for details.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Path [1] :Initial log joint density = -581933.261733
Exception: gamma_lpdf: Inverse scale parameter[1] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 285, column 4 to column 49)
Exception: gamma_lpdf: Inverse scale parameter[1] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 285, column 4 to column 49)
Exception: gamma_lpdf: Inverse scale parameter[1] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 285, column 4 to column 49)
Exception: gamma_lpdf: Inverse scale parameter[1] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 285, column 4 to column 49)
Exception: gamma_lpdf: Inverse scale parameter[1] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 285, column 4 to column 49)
Exception: gamma_lpdf: Inverse scale parameter[1] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 285, column 4 to column 49)
Exception: gamma_lpdf: Inverse scale parameter[2] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 285, column 4 to column 49)
Exception: gamma_lpdf: Inverse scale parameter[168] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 285, column 4 to column 49)
Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
             99      -3.770e+02      5.016e-03   5.652e+01    1.943e-01  1.943e-01      2476 -4.300e+02 -4.300e+02
Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            199      -3.491e+02      8.226e-03   3.397e+01    8.875e-01  8.875e-02      4976 -3.876e+02 -3.876e+02
Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            299      -3.438e+02      3.590e-02   2.966e+01    1.684e-01  1.000e+00      7476 -3.882e+02 -3.882e+02
Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            399      -3.419e+02      1.810e-02   9.491e+00    1.000e+00  1.000e+00      9976 -3.731e+02 -3.731e+02
Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            499      -3.414e+02      1.653e-02   1.297e+01    7.668e-01  7.668e-01     12476 -3.821e+02 -3.821e+02
Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            599      -3.413e+02      3.733e-03   5.598e+00    2.566e-01  1.000e+00     14976 -3.834e+02 -3.834e+02
Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            699      -3.413e+02      1.994e-03   6.201e-01    1.000e+00  1.000e+00     17476 -3.837e+02 -3.837e+02
Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            799      -3.413e+02      2.683e-04   3.517e-01    1.899e-01  9.580e-01     19976 -3.968e+02 -3.968e+02
Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            899      -3.413e+02      2.171e-03   2.386e+00    3.759e-01  1.000e+00     22476 -3.954e+02 -3.954e+02
Path [1] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
            943      -3.413e+02      3.013e-04   8.450e-02    9.576e-01  9.576e-01     23576 -3.751e+02 -3.751e+02
Path [1] :Best Iter: [381] ELBO (-355.535970) evaluations: (23576)
Rejecting initial value:
  Log probability evaluates to log(0), i.e. negative infinity.
  Stan can't start sampling from this initial value.
Path [2] :Initial log joint density = -34817010884313591687565818619494400.000000
Path [2] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
              1      -3.482e+34      0.000e+00   2.862e+36    1.000e-03  1.000e-03         1        nan       -inf
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 264, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 264, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 264, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 264, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 264, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 264, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 264, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 264, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 264, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 264, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 264, column 4 to column 54)
Path [3] :Initial log joint density = -279420342602525441135707607269376.000000
Path [3] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
              1      -2.794e+32      0.000e+00   2.549e+34    1.000e-03  1.000e-03         1        nan       -inf
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 264, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 264, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 264, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 264, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 264, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 264, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 264, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 264, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 264, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 264, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 264, column 4 to column 54)
Path [4] :Initial log joint density = -3045333954366850319022646709801852510763220992.000000
Path [4] : Iter      log prob        ||dx||      ||grad||     alpha      alpha0      # evals       ELBO    Best ELBO        Notes
              1      -3.045e+45      0.000e+00   2.783e+47    1.000e-03  1.000e-03         1        nan       -inf
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 264, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 264, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 264, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 264, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 264, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 264, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 264, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 264, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 264, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 264, column 4 to column 54)
Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 264, column 4 to column 54)
Total log probability function evaluations:24551 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Optimization terminated with error: Line search failed to achieve a sufficient decrease, no more progress can be made Optimization failed to start, pathfinder cannot be run.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Pathfinder iteration: 1 failed.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Optimization terminated with error: Line search failed to achieve a sufficient decrease, no more progress can be made Optimization failed to start, pathfinder cannot be run.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Pathfinder iteration: 2 failed.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Optimization terminated with error: Line search failed to achieve a sufficient decrease, no more progress can be made Optimization failed to start, pathfinder cannot be run.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Pathfinder iteration: 3 failed.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Finished in  0.8 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Pareto k-hat = 1.68. Mean does not exist, making empirical mean estimate of the draws not applicable.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Init values were only set for a subset of parameters.
Missing init values for the following parameters:
 - chain 1: sigma_obs
 - chain 2: sigma_obs
 - chain 3: sigma_obs
 - chain 4: sigma_obs

To disable this message use options(cmdstanr_warn_inits = FALSE).</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Running MCMC with 4 parallel chains...

Chain 1 Iteration:    1 / 2000 [  0%]  (Warmup) </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Exception: gamma_lpdf: Inverse scale parameter[1] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 285, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Exception: gamma_lpdf: Inverse scale parameter[1] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 285, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Exception: gamma_lpdf: Inverse scale parameter[168] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 285, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Exception: gamma_lpdf: Random variable is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 264, column 4 to column 54)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 Exception: gamma_lpdf: Inverse scale parameter[1] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 285, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 1 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Chain 2 Iteration:    1 / 2000 [  0%]  (Warmup) </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Exception: gamma_lpdf: Inverse scale parameter[1] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 285, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Exception: gamma_lpdf: Inverse scale parameter[1] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 285, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Exception: gamma_lpdf: Inverse scale parameter[1] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 285, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Exception: gamma_lpdf: Inverse scale parameter[6] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 285, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Exception: gamma_lpdf: Inverse scale parameter[1] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 285, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 Exception: gamma_lpdf: Inverse scale parameter[1] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 285, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 2 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Chain 3 Iteration:    1 / 2000 [  0%]  (Warmup) </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Exception: gamma_lpdf: Inverse scale parameter[1] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 285, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Exception: gamma_lpdf: Inverse scale parameter[1] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 285, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Exception: gamma_lpdf: Inverse scale parameter[1] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 285, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Exception: gamma_lpdf: Inverse scale parameter[168] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 285, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Exception: gamma_lpdf: Random variable is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 264, column 4 to column 54)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Exception: gamma_lpdf: Inverse scale parameter[1] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 285, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 Exception: gamma_lpdf: Inverse scale parameter[168] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 285, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 3 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Chain 4 Iteration:    1 / 2000 [  0%]  (Warmup) </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Exception: gamma_lpdf: Inverse scale parameter[1] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 285, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Exception: gamma_lpdf: Inverse scale parameter[1] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 285, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Exception: gamma_lpdf: Inverse scale parameter[1] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 285, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Exception: gamma_lpdf: Inverse scale parameter[168] is inf, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 285, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Exception: gamma_lpdf: Random variable is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 264, column 4 to column 54)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Exception: gamma_lpdf: Inverse scale parameter[1] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 285, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 Exception: gamma_lpdf: Inverse scale parameter[2] is 0, but must be positive finite! (in '/tmp/RtmpLCglOO/model-352f61de464c.stan', line 285, column 4 to column 49)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Chain 4 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Chain 1 Iteration:  100 / 2000 [  5%]  (Warmup)
Chain 4 Iteration:  100 / 2000 [  5%]  (Warmup)
Chain 3 Iteration:  100 / 2000 [  5%]  (Warmup)
Chain 2 Iteration:  100 / 2000 [  5%]  (Warmup)
Chain 1 Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 4 Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 3 Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 2 Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 1 Iteration:  300 / 2000 [ 15%]  (Warmup)
Chain 4 Iteration:  300 / 2000 [ 15%]  (Warmup)
Chain 3 Iteration:  300 / 2000 [ 15%]  (Warmup)
Chain 2 Iteration:  300 / 2000 [ 15%]  (Warmup)
Chain 1 Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 4 Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 2 Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 3 Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 1 Iteration:  500 / 2000 [ 25%]  (Warmup)
Chain 2 Iteration:  500 / 2000 [ 25%]  (Warmup)
Chain 4 Iteration:  500 / 2000 [ 25%]  (Warmup)
Chain 3 Iteration:  500 / 2000 [ 25%]  (Warmup)
Chain 1 Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 2 Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 4 Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 3 Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 1 Iteration:  700 / 2000 [ 35%]  (Warmup)
Chain 2 Iteration:  700 / 2000 [ 35%]  (Warmup)
Chain 4 Iteration:  700 / 2000 [ 35%]  (Warmup)
Chain 1 Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 2 Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 3 Iteration:  700 / 2000 [ 35%]  (Warmup)
Chain 4 Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 1 Iteration:  900 / 2000 [ 45%]  (Warmup)
Chain 2 Iteration:  900 / 2000 [ 45%]  (Warmup)
Chain 3 Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 4 Iteration:  900 / 2000 [ 45%]  (Warmup)
Chain 1 Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 1 Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 2 Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 2 Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 3 Iteration:  900 / 2000 [ 45%]  (Warmup)
Chain 4 Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 4 Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 1 Iteration: 1100 / 2000 [ 55%]  (Sampling)
Chain 2 Iteration: 1100 / 2000 [ 55%]  (Sampling)
Chain 3 Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 3 Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 4 Iteration: 1100 / 2000 [ 55%]  (Sampling)
Chain 1 Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 2 Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 3 Iteration: 1100 / 2000 [ 55%]  (Sampling)
Chain 4 Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 2 Iteration: 1300 / 2000 [ 65%]  (Sampling)
Chain 1 Iteration: 1300 / 2000 [ 65%]  (Sampling)
Chain 3 Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 4 Iteration: 1300 / 2000 [ 65%]  (Sampling)
Chain 1 Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 2 Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 4 Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 3 Iteration: 1300 / 2000 [ 65%]  (Sampling)
Chain 1 Iteration: 1500 / 2000 [ 75%]  (Sampling)
Chain 2 Iteration: 1500 / 2000 [ 75%]  (Sampling)
Chain 4 Iteration: 1500 / 2000 [ 75%]  (Sampling)
Chain 3 Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 2 Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 4 Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 1 Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 3 Iteration: 1500 / 2000 [ 75%]  (Sampling)
Chain 2 Iteration: 1700 / 2000 [ 85%]  (Sampling)
Chain 4 Iteration: 1700 / 2000 [ 85%]  (Sampling)
Chain 1 Iteration: 1700 / 2000 [ 85%]  (Sampling)
Chain 2 Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 3 Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 4 Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 1 Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 4 Iteration: 1900 / 2000 [ 95%]  (Sampling)
Chain 1 Iteration: 1900 / 2000 [ 95%]  (Sampling)
Chain 2 Iteration: 1900 / 2000 [ 95%]  (Sampling)
Chain 3 Iteration: 1700 / 2000 [ 85%]  (Sampling)
Chain 4 Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 4 finished in 10.1 seconds.
Chain 1 Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 2 Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 1 finished in 10.2 seconds.
Chain 2 finished in 10.1 seconds.
Chain 3 Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 3 Iteration: 1900 / 2000 [ 95%]  (Sampling)
Chain 3 Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 3 finished in 10.7 seconds.

All 4 chains finished successfully.
Mean chain execution time: 10.3 seconds.
Total execution time: 10.7 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 2 of 4000 (0.0%) transitions ended with a divergence.
See https://mc-stan.org/misc/warnings for details.</code></pre>
</div>
</div>
<p>To compare models goodness-of-fit we use the <code>loo</code> package, which implements the Leave-One-Out Information Criterion <span class="citation" data-cites="vehtari2017practical">(LOOIC, <a href="#ref-vehtari2017practical" role="doc-biblioref">Vehtari, Gelman, and Gabry 2017</a>)</span>. First, we create a list with the LOOIC for each model, and then compare them using the <code>loo_compare</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb922"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">loos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"baseline"</span> <span class="op">=</span> <span class="va">baseline</span><span class="op">$</span><span class="va">stanfit</span><span class="op">$</span><span class="fu">loo</span><span class="op">(</span><span class="op">)</span>,</span>
<span>             <span class="st">"drm_1"</span> <span class="op">=</span> <span class="va">drm_1</span><span class="op">$</span><span class="va">stanfit</span><span class="op">$</span><span class="fu">loo</span><span class="op">(</span><span class="op">)</span>,</span>
<span>             <span class="st">"drm_2"</span> <span class="op">=</span> <span class="va">drm_2</span><span class="op">$</span><span class="va">stanfit</span><span class="op">$</span><span class="fu">loo</span><span class="op">(</span><span class="op">)</span>,</span>
<span>             <span class="st">"drm_3"</span> <span class="op">=</span> <span class="va">drm_3</span><span class="op">$</span><span class="va">stanfit</span><span class="op">$</span><span class="fu">loo</span><span class="op">(</span><span class="op">)</span>,</span>
<span>             <span class="st">"drm_4"</span> <span class="op">=</span> <span class="va">drm_4</span><span class="op">$</span><span class="va">stanfit</span><span class="op">$</span><span class="fu">loo</span><span class="op">(</span><span class="op">)</span>,</span>
<span>             <span class="st">"drm_5"</span> <span class="op">=</span> <span class="va">drm_5</span><span class="op">$</span><span class="va">stanfit</span><span class="op">$</span><span class="fu">loo</span><span class="op">(</span><span class="op">)</span>,</span>
<span>             <span class="st">"drm_6"</span> <span class="op">=</span> <span class="va">drm_6</span><span class="op">$</span><span class="va">stanfit</span><span class="op">$</span><span class="fu">loo</span><span class="op">(</span><span class="op">)</span>,</span>
<span>             <span class="st">"drm_7"</span> <span class="op">=</span> <span class="va">drm_7</span><span class="op">$</span><span class="va">stanfit</span><span class="op">$</span><span class="fu">loo</span><span class="op">(</span><span class="op">)</span>,</span>
<span>             <span class="st">"sdm"</span>   <span class="op">=</span> <span class="va">sdm</span><span class="op">$</span><span class="va">stanfit</span><span class="op">$</span><span class="fu">loo</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">loos_out</span> <span class="op">&lt;-</span> <span class="fu">loo</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/loo/reference/loo_compare.html" class="external-link">loo_compare</a></span><span class="op">(</span><span class="va">loos</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Some Pareto k diagnostic values are too high. See help('pareto-k-diagnostic') for details.
Warning: Some Pareto k diagnostic values are too high. See help('pareto-k-diagnostic') for details.
Warning: Some Pareto k diagnostic values are too high. See help('pareto-k-diagnostic') for details.
Warning: Some Pareto k diagnostic values are too high. See help('pareto-k-diagnostic') for details.</code></pre>
</div>
</div>
<p>The <code>loo_compare</code> outputs a table with the difference between the LOOIC from the best model (in terms of LOOIC as a goodness-of-fit metric) to each of the models and orders those differences from “best” to “worst” fit.</p>
<p>The model with the best goodness-of-fit does not necessarily delivers the best predictions (or forecasts). The forecasts for each model are easily computed through the <code>predict_drm</code> (or <code>predict_sdm</code>, if applied to the output of <code>fit_sdm</code>) function. See below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb924"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">forecast_0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_drm.html">predict_drm</a></span><span class="op">(</span>drm <span class="op">=</span> <span class="va">baseline</span>,</span>
<span>                          new_data <span class="op">=</span> <span class="va">dat_test</span>,</span>
<span>                          seed <span class="op">=</span> <span class="fl">125</span>,</span>
<span>                          cores <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="va">forecast_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_drm.html">predict_drm</a></span><span class="op">(</span>drm <span class="op">=</span> <span class="va">drm_1</span>,</span>
<span>                          new_data <span class="op">=</span> <span class="va">dat_test</span>,</span>
<span>                          seed <span class="op">=</span> <span class="fl">125</span>,</span>
<span>                          cores <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="va">forecast_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_drm.html">predict_drm</a></span><span class="op">(</span>drm <span class="op">=</span> <span class="va">drm_2</span>,</span>
<span>                          new_data <span class="op">=</span> <span class="va">dat_test</span>,</span>
<span>                          past_data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dat_train</span>,</span>
<span>                                             <span class="va">year</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                          seed <span class="op">=</span> <span class="fl">125</span>,</span>
<span>                          cores <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="va">forecast_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_drm.html">predict_drm</a></span><span class="op">(</span>drm <span class="op">=</span> <span class="va">drm_3</span>,</span>
<span>                          new_data <span class="op">=</span> <span class="va">dat_test</span>,</span>
<span>                          past_data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dat_train</span>,</span>
<span>                                             <span class="va">year</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                          seed <span class="op">=</span> <span class="fl">125</span>,</span>
<span>                          cores <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="va">forecast_4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_drm.html">predict_drm</a></span><span class="op">(</span>drm <span class="op">=</span> <span class="va">drm_4</span>,</span>
<span>                          new_data <span class="op">=</span> <span class="va">dat_test</span>,</span>
<span>                          past_data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dat_train</span>,</span>
<span>                                             <span class="va">year</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                          seed <span class="op">=</span> <span class="fl">125</span>,</span>
<span>                          cores <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="va">forecast_5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_drm.html">predict_drm</a></span><span class="op">(</span>drm <span class="op">=</span> <span class="va">drm_5</span>,</span>
<span>                          new_data <span class="op">=</span> <span class="va">dat_test</span>,</span>
<span>                          past_data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dat_train</span>,</span>
<span>                                             <span class="va">year</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                          seed <span class="op">=</span> <span class="fl">125</span>,</span>
<span>                          cores <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="va">forecast_6</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_drm.html">predict_drm</a></span><span class="op">(</span>drm <span class="op">=</span> <span class="va">drm_6</span>,</span>
<span>                          new_data <span class="op">=</span> <span class="va">dat_test</span>,</span>
<span>                          past_data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dat_train</span>,</span>
<span>                                             <span class="va">year</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                          f_test <span class="op">=</span> <span class="va">f_test</span>,</span>
<span>                          seed <span class="op">=</span> <span class="fl">125</span>,</span>
<span>                          cores <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="va">forecast_7</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_drm.html">predict_drm</a></span><span class="op">(</span>drm <span class="op">=</span> <span class="va">drm_7</span>,</span>
<span>                          new_data <span class="op">=</span> <span class="va">dat_test</span>,</span>
<span>                          past_data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dat_train</span>,</span>
<span>                                             <span class="va">year</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                          seed <span class="op">=</span> <span class="fl">125</span>,</span>
<span>                          cores <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="va">forecast_sdm</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/predict_sdm.html">predict_sdm</a></span><span class="op">(</span>sdm <span class="op">=</span> <span class="va">sdm</span>,</span>
<span>              new_data <span class="op">=</span> <span class="va">dat_test</span>,</span>
<span>              seed <span class="op">=</span> <span class="fl">125</span>,</span>
<span>              cores <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="co">##--- summarizing forecasts ----</span></span>
<span></span>
<span><span class="va">all_forecasts</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"^forecast_"</span><span class="op">)</span></span>
<span><span class="va">all_drms</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"^(baseline|drm_|sdm)"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">forecasts_summary</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Map</a></span><span class="op">(</span>f <span class="op">=</span> \<span class="op">(</span><span class="va">x</span>, <span class="va">nm</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">fct</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/get.html" class="external-link">get</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>    <span class="va">fct</span><span class="op">$</span><span class="fu">draws</span><span class="op">(</span>variables <span class="op">=</span> <span class="st">"y_proj"</span>,</span>
<span>              format <span class="op">=</span> <span class="st">"draws_df"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"y_proj"</span><span class="op">)</span>,</span>
<span>                          names_to <span class="op">=</span> <span class="st">"pair"</span>,</span>
<span>                          values_to <span class="op">=</span> <span class="st">"expected"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">pair</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>ll <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">expected</span>, probs <span class="op">=</span> <span class="fl">.05</span><span class="op">)</span>,</span>
<span>                l <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">expected</span>, probs <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span>,</span>
<span>                m <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">expected</span><span class="op">)</span>,</span>
<span>                u <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">expected</span>, probs <span class="op">=</span> <span class="fl">.9</span><span class="op">)</span>,</span>
<span>                uu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">expected</span>, probs <span class="op">=</span> <span class="fl">.95</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>pair <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"\\D"</span>, <span class="st">""</span>, <span class="va">pair</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>pair <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">pair</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">pair</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">nm</span>,</span>
<span>             .before <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">}</span>, x <span class="op">=</span> <span class="va">all_forecasts</span>, nm <span class="op">=</span> <span class="va">all_drms</span><span class="op">)</span></span>
<span></span>
<span><span class="va">forecasts_summary</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">forecasts_summary</span><span class="op">)</span></span>
<span></span>
<span><span class="va">forecasts_summary</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">dat_test</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">dens</span>, <span class="va">lat_floor</span>, <span class="va">patch</span>, <span class="va">year</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>pair <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/row_number.html" class="external-link">row_number</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">forecasts_summary</span>, by <span class="op">=</span> <span class="st">"pair"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Running standalone generated quantities after 4 MCMC chains, all chains in parallel ...

Chain 1 finished in 0.0 seconds.
Chain 2 finished in 0.0 seconds.
Chain 3 finished in 0.0 seconds.
Chain 4 finished in 0.0 seconds.

All 4 chains finished successfully.
Mean chain execution time: 0.0 seconds.
Total execution time: 0.3 seconds.
Running standalone generated quantities after 4 MCMC chains, all chains in parallel ...

Chain 1 finished in 0.0 seconds.
Chain 2 finished in 0.0 seconds.
Chain 3 finished in 0.0 seconds.
Chain 4 finished in 0.0 seconds.

All 4 chains finished successfully.
Mean chain execution time: 0.0 seconds.
Total execution time: 0.3 seconds.
Running standalone generated quantities after 4 MCMC chains, all chains in parallel ...

Chain 1 finished in 0.0 seconds.
Chain 2 finished in 0.0 seconds.
Chain 3 finished in 0.0 seconds.
Chain 4 finished in 0.0 seconds.

All 4 chains finished successfully.
Mean chain execution time: 0.0 seconds.
Total execution time: 0.3 seconds.
Running standalone generated quantities after 4 MCMC chains, all chains in parallel ...

Chain 1 finished in 0.0 seconds.
Chain 2 finished in 0.0 seconds.
Chain 3 finished in 0.0 seconds.
Chain 4 finished in 0.0 seconds.

All 4 chains finished successfully.
Mean chain execution time: 0.0 seconds.
Total execution time: 0.3 seconds.
Running standalone generated quantities after 4 MCMC chains, all chains in parallel ...

Chain 1 finished in 0.0 seconds.
Chain 2 finished in 0.0 seconds.
Chain 3 finished in 0.0 seconds.
Chain 4 finished in 0.0 seconds.

All 4 chains finished successfully.
Mean chain execution time: 0.0 seconds.
Total execution time: 0.5 seconds.
Running standalone generated quantities after 4 MCMC chains, all chains in parallel ...

Chain 1 finished in 0.0 seconds.
Chain 2 finished in 0.0 seconds.
Chain 3 finished in 0.0 seconds.
Chain 4 finished in 0.0 seconds.

All 4 chains finished successfully.
Mean chain execution time: 0.0 seconds.
Total execution time: 0.4 seconds.
Running standalone generated quantities after 4 MCMC chains, all chains in parallel ...

Chain 1 finished in 0.0 seconds.
Chain 2 finished in 0.0 seconds.
Chain 3 finished in 0.0 seconds.
Chain 4 finished in 0.0 seconds.

All 4 chains finished successfully.
Mean chain execution time: 0.0 seconds.
Total execution time: 0.7 seconds.
Running standalone generated quantities after 4 MCMC chains, all chains in parallel ...

Chain 1 finished in 0.0 seconds.
Chain 2 finished in 0.0 seconds.
Chain 3 finished in 0.0 seconds.
Chain 4 finished in 0.0 seconds.

All 4 chains finished successfully.
Mean chain execution time: 0.0 seconds.
Total execution time: 0.3 seconds.
Running standalone generated quantities after 4 MCMC chains, all chains in parallel ...

Chain 1 finished in 0.0 seconds.
Chain 2 finished in 0.0 seconds.
Chain 3 finished in 0.0 seconds.
Chain 4 finished in 0.0 seconds.

All 4 chains finished successfully.
Mean chain execution time: 0.0 seconds.
Total execution time: 0.2 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Dropping 'draws_df' class as required metadata was removed.
Warning: Dropping 'draws_df' class as required metadata was removed.
Warning: Dropping 'draws_df' class as required metadata was removed.
Warning: Dropping 'draws_df' class as required metadata was removed.
Warning: Dropping 'draws_df' class as required metadata was removed.
Warning: Dropping 'draws_df' class as required metadata was removed.
Warning: Dropping 'draws_df' class as required metadata was removed.
Warning: Dropping 'draws_df' class as required metadata was removed.
Warning: Dropping 'draws_df' class as required metadata was removed.</code></pre>
</div>
</div>
<p>Now, we display the comparisons of Goodness-of-fit and predictive skill. In that table, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Δ</mi><annotation encoding="application/x-tex">\Delta</annotation></semantics></math>-LOOIC represents the difference between the LOOIC and the model with the best fit; RMSE is the root mean square error of prediction; IS is the interval score; PIC is the frequentist coverage of the 80% prediction intervals; and Time is the time (in seconds) to fit the models.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb927"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">forecasts_summary</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>bias <span class="op">=</span> <span class="va">dens</span> <span class="op">-</span> <span class="va">m</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>rmse <span class="op">=</span> <span class="va">bias</span> <span class="op">*</span> <span class="va">bias</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>is <span class="op">=</span> <span class="fu"><a href="../reference/int_score.html">int_score</a></span><span class="op">(</span><span class="va">dens</span>, l <span class="op">=</span> <span class="va">l</span>, u <span class="op">=</span> <span class="va">u</span>, alpha <span class="op">=</span> <span class="fl">.2</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>cvg <span class="op">=</span> <span class="fl">100</span> <span class="op">*</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/between.html" class="external-link">between</a></span><span class="op">(</span><span class="va">dens</span>, <span class="va">l</span>, <span class="va">u</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="va">rmse</span><span class="op">:</span><span class="va">cvg</span>, <span class="va">mean</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select_all.html" class="external-link">rename_all</a></span><span class="op">(</span><span class="va">toupper</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span><span class="st">"Model"</span> <span class="op">=</span> <span class="st">"MODEL"</span>,</span>
<span>         <span class="st">"IS (80%)"</span> <span class="op">=</span> <span class="st">"IS"</span>,</span>
<span>         <span class="st">"PIC (80%)"</span> <span class="op">=</span> <span class="st">"CVG"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">aux_qt</span>,</span>
<span>            by <span class="op">=</span> <span class="st">"Model"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">LOOIC</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html" class="external-link">relocate</a></span><span class="op">(</span><span class="va">LOOIC</span>, .after <span class="op">=</span> <span class="st">"Model"</span><span class="op">)</span></span></code></pre></div>
</div>
<table class="table caption-top">
<colgroup>
<col style="width: 17%">
<col style="width: 23%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Model</th>
<th style="text-align: right;">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Δ</mi><annotation encoding="application/x-tex">\Delta</annotation></semantics></math>-LOOIC</th>
<th style="text-align: right;">RMSE</th>
<th style="text-align: right;">IS</th>
<th style="text-align: right;">PIC</th>
<th style="text-align: right;">Time</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>drm_3</code></td>
<td style="text-align: right;"><strong>0.00</strong></td>
<td style="text-align: right;">8.98</td>
<td style="text-align: right;"><strong>8.60</strong></td>
<td style="text-align: right;"><strong>78.0</strong></td>
<td style="text-align: right;">13.34</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>sdm</code></td>
<td style="text-align: right;">-6.07</td>
<td style="text-align: right;">12.04</td>
<td style="text-align: right;">12.72</td>
<td style="text-align: right;">60.0</td>
<td style="text-align: right;">3.88</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>drm_4</code></td>
<td style="text-align: right;">-7.35</td>
<td style="text-align: right;">8.30</td>
<td style="text-align: right;">8.87</td>
<td style="text-align: right;">84.0</td>
<td style="text-align: right;">28.70</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>drm_5</code></td>
<td style="text-align: right;">-7.74</td>
<td style="text-align: right;"><strong>8.23</strong></td>
<td style="text-align: right;">8.96</td>
<td style="text-align: right;">86.0</td>
<td style="text-align: right;">19.24</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>drm_7</code></td>
<td style="text-align: right;">-10.41</td>
<td style="text-align: right;">8.75</td>
<td style="text-align: right;">8.97</td>
<td style="text-align: right;">78.0</td>
<td style="text-align: right;">22.73</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>drm_6</code></td>
<td style="text-align: right;">-18.04</td>
<td style="text-align: right;">10.22</td>
<td style="text-align: right;">10.49</td>
<td style="text-align: right;">86.0</td>
<td style="text-align: right;">33.73</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>drm_1</code></td>
<td style="text-align: right;">-22.49</td>
<td style="text-align: right;">11.17</td>
<td style="text-align: right;">10.68</td>
<td style="text-align: right;">68.0</td>
<td style="text-align: right;">4.67</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>drm_2</code></td>
<td style="text-align: right;">-32.32</td>
<td style="text-align: right;">10.73</td>
<td style="text-align: right;">10.29</td>
<td style="text-align: right;">68.0</td>
<td style="text-align: right;">4.44</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>baseline</code></td>
<td style="text-align: right;">-163.85</td>
<td style="text-align: right;">14.44</td>
<td style="text-align: right;">12.98</td>
<td style="text-align: right;">74.0</td>
<td style="text-align: right;"><strong>1.35</strong></td>
</tr>
</tbody>
</table>
<p>Despite having the second-best model fit based on LOOIC, the SDM yielded the second-worst predictive performance according to RMSE and IS. This suggests the DRM’s mechanistic formulation enhances forecasting ability, potentially outweighing a slightly less optimal fit statistic. This is understandable, as DRMs incorporate biologically-informed constraints that can improve predictions.</p>
</section><section class="level2"><h2 id="coming-soon">Coming soon<a class="anchor" aria-label="anchor" href="#coming-soon"></a>
</h2>
<p>We are working on the following additional vignettes:</p>
<ul>
<li><p>priors used in our models and how to modify them</p></li>
<li><p>toggles and their specific options</p></li>
<li><p>Initialization of the population dynamics</p></li>
</ul></section><section class="level2 unnumbered"><h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-fredston2025dynamic" class="csl-entry" role="listitem">
Fredston, Alexa, Daniel Ovando, Lucas da Cunha Godoy, Jude Kong, Brandon Muffley, James T Thorson, and Malin Pinsky. 2025. <span>“Dynamic Range Models Improve the Near-Term Forecast for a Marine Species on the Move.”</span> <em>Ecology Letters</em> 00: (under review). <a href="https://doi.org/10.32942/X24D00" class="external-link">https://doi.org/10.32942/X24D00</a>.
</div>
<div id="ref-gabry2024cmdstanr" class="csl-entry" role="listitem">
Gabry, Jonah, Rok Çešnovar, Andrew Johnson, and Steve Bronder. 2024. <em>Cmdstanr: R Interface to <span>CmdStan</span></em>. <a href="https://github.com/stan-dev/cmdstanr" class="external-link">https://github.com/stan-dev/cmdstanr</a>.
</div>
<div id="ref-landau2024instantiate" class="csl-entry" role="listitem">
Landau, William Michael. 2024. <em>Instantiate: Pre-Compiled <span>CmdStan</span> Models in <span>R</span> Packages</em>. <a href="https://CRAN.R-project.org/package=instantiate" class="external-link">https://CRAN.R-project.org/package=instantiate</a>.
</div>
<div id="ref-vehtari2017practical" class="csl-entry" role="listitem">
Vehtari, Aki, Andrew Gelman, and Jonah Gabry. 2017. <span>“Practical Bayesian Model Evaluation Using Leave-One-Out Cross-Validation and WAIC.”</span> <em>Statistics and Computing</em> 27: 1413–32.
</div>
<div id="ref-zhang2022pathfinder" class="csl-entry" role="listitem">
Zhang, Lu, Bob Carpenter, Andrew Gelman, and Aki Vehtari. 2022. <span>“Pathfinder: Parallel Quasi-Newton Variational Inference.”</span> <em>Journal of Machine Learning Research</em> 23 (306): 1–49. <a href="http://jmlr.org/papers/v23/21-0889.html" class="external-link">http://jmlr.org/papers/v23/21-0889.html</a>.
</div>
</div>
</section><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config);
    }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script></main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Lucas da Cunha Godoy.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
