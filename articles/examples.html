<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Examples • drmr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="examples_files/libs/quarto-html/popper.min.js"></script><script src="examples_files/libs/quarto-html/tippy.umd.min.js"></script><link href="examples_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="examples_files/libs/quarto-html/light-border.css" rel="stylesheet">
<!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Examples">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">drmr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.00</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/examples.html">Examples</a></li>
    <li><a class="dropdown-item" href="../articles/get-started.html">Get Started</a></li>
    <li><a class="dropdown-item" href="../articles/theory.html">Theoretical Background</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/pinskylab/drmr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-quarto">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Examples</h1>

      <p class="author">Lucas da Cunha Godoy</p>


      <small class="dont-index">Source: <a href="https://github.com/pinskylab/drmr/blob/main/vignettes/examples.qmd" class="external-link"><code>vignettes/examples.qmd</code></a></small>
      <div class="d-none name"><code></code></div>
    </div>






    <hr>
<section class="level2 unnumbered"><h2 class="unnumbered" id="tl-dr">TL; DR<a class="anchor" aria-label="anchor" href="#tl-dr"></a>
</h2>
<p>This document demonstrates the functionalities of the <code>drmr</code> R package for fitting Dynamic Range and Species Distribution Models (DRMs and SDMs, respectively) using pre-compiled <code>Stan</code> models.</p>
<p>We’ll explore increasingly complex models, showcasing the package’s capabilities with the help of five additional <code>R</code> packages:</p>
<ul>
<li>
<code>sf</code>: for spatial data manipulation and visualization</li>
<li>
<code>ggplot2</code>: for creating graphs</li>
<li>
<code>bayesplot</code>: for visualizing MCMC outputs</li>
<li>
<code>dplyr</code>: for data wrangling</li>
</ul></section><section class="level2"><h2 id="sec-drmr">Installing the <code>drmr</code> package<a class="anchor" aria-label="anchor" href="#sec-drmr"></a>
</h2>
<p>The <code>drmr</code> package provides pre-compiled <code>cmdstanr</code> <span class="citation" data-cites="gabry2024cmdstanr">(<a href="#ref-gabry2024cmdstanr" role="doc-biblioref">Gabry et al. 2024</a>)</span> models powered by the <code>instantiate</code> package <span class="citation" data-cites="landau2024instantiate">(<a href="#ref-landau2024instantiate" role="doc-biblioref">Landau 2024</a>)</span>. These pre-compiled models allow us to make inferences about the DRM (and SDM) using <code>cmdstan</code> algorithms, such as the HMC NUTS Sampler.</p>
<p>The package is not on CRAN yet. To install the version hosted on GitHub, run:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"pinskylab/drmr"</span><span class="op">)</span></span></code></pre></div>
</div>
<p>Finally, the code below loads the packages necessary to reproduce the examples in this document.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://pinskylab.github.io/drmr/">drmr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span> <span class="co">## "mapping"</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span> <span class="co">## graphs</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mc-stan.org/bayesplot/" class="external-link">bayesplot</a></span><span class="op">)</span> <span class="co">## and more graphs</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
</div>
</section><section class="level2"><h2 id="sec-data">Data<a class="anchor" aria-label="anchor" href="#sec-data"></a>
</h2>
<p>For this example, we’ll use the package’s built-in <em>Summer flounder</em> dataset, which resembles the data analyzed in <span class="citation" data-cites="fredston2025dynamic">Fredston et al. (<a href="#ref-fredston2025dynamic" role="doc-biblioref">2025</a>)</span>. We load it by running:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## loads the data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">sum_fl</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## computing density</span></span>
<span><span class="va">sum_fl</span> <span class="op">&lt;-</span> <span class="va">sum_fl</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>dens <span class="op">=</span> <span class="fl">1000</span> <span class="op">*</span> <span class="va">y</span> <span class="op">/</span> <span class="va">area_km2</span>,</span>
<span>         .before <span class="op">=</span> <span class="va">y</span><span class="op">)</span></span></code></pre></div>
</div>
<p>A quick exploration of the data reveals the following:</p>
<ul>
<li><p>Surface salinity (ssalin) and bottom salinity (bsalin) have missing values (around 30% missing for each).</p></li>
<li><p>At least 25% of the density (<code>dens</code>) values are zero.</p></li>
</ul>
<p>Finally, we split the data, reserving the last five years for evaluating predictions:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## 5 years-ahead predictions</span></span>
<span><span class="va">first_year_forecast</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">sum_fl</span><span class="op">$</span><span class="va">year</span><span class="op">)</span> <span class="op">-</span> <span class="fl">5</span></span>
<span></span>
<span><span class="va">first_id_forecast</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">first_year_forecast</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">sum_fl</span><span class="op">$</span><span class="va">year</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span></span>
<span></span>
<span><span class="co">## splitting data</span></span>
<span><span class="va">dat_test</span> <span class="op">&lt;-</span> <span class="va">sum_fl</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op">&gt;=</span> <span class="va">first_year_forecast</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat_train</span> <span class="op">&lt;-</span> <span class="va">sum_fl</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op">&lt;</span> <span class="va">first_year_forecast</span><span class="op">)</span></span></code></pre></div>
</div>
<p>When fitting models with explanatory variables, it’s good practice to standardize them by centering (subtracting the mean) and scaling (dividing by the standard deviation). This transformation to zero mean and unit variance offers two main benefits: it typically improves the efficiency of Monte Carlo Markov Chain (MCMC) sampling, and it makes comparing the magnitude of regression coefficients easier for assessing relative variable importance. For applications involving forecasting or prediction, it is crucial to calculate the mean and standard deviation for standardization using only the training dataset. These exact same values must then be applied to standardize the test dataset (or any future data), simulating the real-world scenario where information about future observations is unavailable during model fitting.</p>
<p>In that spirit, we center and scale some of our potential explanatory variables as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">avgs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"stemp"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dat_train</span><span class="op">$</span><span class="va">stemp</span><span class="op">)</span>,</span>
<span>          <span class="st">"btemp"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dat_train</span><span class="op">$</span><span class="va">btemp</span><span class="op">)</span>,</span>
<span>          <span class="st">"depth"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dat_train</span><span class="op">$</span><span class="va">depth</span><span class="op">)</span>,</span>
<span>          <span class="st">"n_hauls"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dat_train</span><span class="op">$</span><span class="va">n_hauls</span><span class="op">)</span>,</span>
<span>          <span class="st">"lat"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dat_train</span><span class="op">$</span><span class="va">lat</span><span class="op">)</span>,</span>
<span>          <span class="st">"lon"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dat_train</span><span class="op">$</span><span class="va">lon</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">min_year</span> <span class="op">&lt;-</span> <span class="va">dat_train</span><span class="op">$</span><span class="va">year</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## centering covariates</span></span>
<span><span class="va">dat_train</span> <span class="op">&lt;-</span> <span class="va">dat_train</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>c_stemp <span class="op">=</span> <span class="va">stemp</span> <span class="op">-</span> <span class="va">avgs</span><span class="op">[</span><span class="st">"stemp"</span><span class="op">]</span>,</span>
<span>         c_btemp <span class="op">=</span> <span class="va">btemp</span> <span class="op">-</span> <span class="va">avgs</span><span class="op">[</span><span class="st">"btemp"</span><span class="op">]</span>,</span>
<span>         c_hauls <span class="op">=</span> <span class="va">n_hauls</span> <span class="op">-</span> <span class="va">avgs</span><span class="op">[</span><span class="st">"n_hauls"</span><span class="op">]</span>,</span>
<span>         <span class="co">## depth = depth - avgs["depth"],</span></span>
<span>         c_lat   <span class="op">=</span> <span class="va">lat</span> <span class="op">-</span> <span class="va">avgs</span><span class="op">[</span><span class="st">"lat"</span><span class="op">]</span>,</span>
<span>         c_lon   <span class="op">=</span> <span class="va">lon</span> <span class="op">-</span> <span class="va">avgs</span><span class="op">[</span><span class="st">"lon"</span><span class="op">]</span>,</span>
<span>         time  <span class="op">=</span> <span class="va">year</span> <span class="op">-</span> <span class="va">min_year</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat_test</span> <span class="op">&lt;-</span> <span class="va">dat_test</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>c_stemp <span class="op">=</span> <span class="va">stemp</span> <span class="op">-</span> <span class="va">avgs</span><span class="op">[</span><span class="st">"stemp"</span><span class="op">]</span>,</span>
<span>         c_btemp <span class="op">=</span> <span class="va">btemp</span> <span class="op">-</span> <span class="va">avgs</span><span class="op">[</span><span class="st">"btemp"</span><span class="op">]</span>,</span>
<span>         c_hauls <span class="op">=</span> <span class="va">n_hauls</span> <span class="op">-</span> <span class="va">avgs</span><span class="op">[</span><span class="st">"n_hauls"</span><span class="op">]</span>,</span>
<span>         <span class="co">## depth = depth - avgs["depth"],</span></span>
<span>         c_lat   <span class="op">=</span> <span class="va">lat</span> <span class="op">-</span> <span class="va">avgs</span><span class="op">[</span><span class="st">"lat"</span><span class="op">]</span>,</span>
<span>         c_lon   <span class="op">=</span> <span class="va">lon</span> <span class="op">-</span> <span class="va">avgs</span><span class="op">[</span><span class="st">"lon"</span><span class="op">]</span>,</span>
<span>         time  <span class="op">=</span> <span class="va">year</span> <span class="op">-</span> <span class="va">min_year</span><span class="op">)</span></span></code></pre></div>
</div>
<blockquote>
<p>For an extensive list of the explanatory variables available on the dataset, run: <code><a href="../reference/sum_fl.html">?sum_fl</a></code>.</p>
</blockquote>
</section><section class="level2"><h2 id="fitting-and-comparing-models">Fitting and comparing models<a class="anchor" aria-label="anchor" href="#fitting-and-comparing-models"></a>
</h2>
<p>Let’s begin by fitting the simplest DRM available, we will call it our <code>baseline</code>. By default, the simplest <code>fit_drm</code> call assumes two age-groups and a survival rate of <code>0.70</code> between age-classes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">baseline</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/fit_drm.html">fit_drm</a></span><span class="op">(</span>.data <span class="op">=</span> <span class="va">dat_train</span>,</span>
<span>          y_col    <span class="op">=</span> <span class="st">"dens"</span>, <span class="co">## response variable: density</span></span>
<span>          time_col <span class="op">=</span> <span class="st">"year"</span>, <span class="co">## vector of time points</span></span>
<span>          site_col <span class="op">=</span> <span class="st">"patch"</span>,</span>
<span>          seed <span class="op">=</span> <span class="fl">202505</span><span class="op">)</span></span></code></pre></div>
</div>
<p>This function has many arguments. We need to input at least the following:</p>
<ul>
<li><p><code>.data</code> - a <code>data.frame</code>;</p></li>
<li><p><code>y_col</code> - a <code>character</code> indicating the name of the column (or variable) storing the response variable in <code>.data</code>.</p></li>
<li><p><code>time_col</code> - a <code>character</code> indicating the name of the column (or variable) storing the time variable in <code>.data</code>.</p></li>
<li><p><code>site_col</code> - a <code>character</code> indicating the name of the column (or variable) storing the site variable in <code>.data</code>.</p></li>
<li><p><code>seed</code> - a <code>integer</code> corresponding to a seed for random number generation. This parameter helps to ensure reproducibility.</p></li>
</ul>
<p>Moreover, the output of a <code>fit_drm</code> call results in a named list. Its most important element is the <code>stanfit</code>, which is equivalent to the output of <a href="%60sample()%60">https://mc-stan.org/cmdstanr/reference/model-method-sample.html</a>. The remaining additional elements are useful for calculating predictions.</p>
<p>It is more interesting to have the expected density and probabilities of absence varying according to environmental variables. To achieve that, we input formulas to the <code>formula_zero</code> and <code>formula_rec</code> arguments. The specific call to <code>fit_drm</code> is as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">drm_1</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/fit_drm.html">fit_drm</a></span><span class="op">(</span>.data <span class="op">=</span> <span class="va">dat_train</span>,</span>
<span>          y_col <span class="op">=</span> <span class="st">"dens"</span>,</span>
<span>          time_col <span class="op">=</span> <span class="st">"year"</span>,</span>
<span>          site_col <span class="op">=</span> <span class="st">"patch"</span>,</span>
<span>          seed <span class="op">=</span> <span class="fl">202505</span>,</span>
<span>          formula_zero <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">c_hauls</span> <span class="op">+</span> <span class="va">c_btemp</span> <span class="op">+</span> <span class="va">c_stemp</span>,</span>
<span>          formula_rec <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">c_stemp</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">c_stemp</span> <span class="op">*</span> <span class="va">c_stemp</span><span class="op">)</span>,</span>
<span>          init <span class="op">=</span> <span class="st">"pathfinder"</span><span class="op">)</span></span></code></pre></div>
</div>
<p>In this call we also introduce the <code>init</code> argument. This argument controls how the MCMC algorithm is initialized. There are three different initialization options:</p>
<ul>
<li><p><code>"default"</code>: the default initialization method in <code>cmdstan</code>.</p></li>
<li><p><code>"prior"</code>: Initializes the parameters with samples from their prior distributions.</p></li>
<li><p><code>"pathfinder"</code>: Uses the Pathfinder algorithm <span class="citation" data-cites="zhang2022pathfinder">(<a href="#ref-zhang2022pathfinder" role="doc-biblioref">Zhang et al. 2022</a>)</span> for the initialization.</p></li>
</ul>
<p>For further info, see <code><a href="../reference/fit_drm.html">?fit_drm</a></code>.</p>
<p>We can easily fit several models to a specific dataset, exploring different features and increasing levels of complexity. The simplest model was the <code>baseline</code>. Building upon this, <code>drm_1</code> introduced specific covariate effects, modeling recruitment as a quadratic function of Sea Surface Temperature (SST) and the probability of absence as dependent on the number of hauls, SST, and Sea Bottom Temperature (SBT).</p>
<p>In the code chunk below, model <code>drm_2</code> adds the estimation of a constant survival rate to the features of <code>drm_1</code>. Subsequently, <code>drm_3</code> incorporated an AR(1) temporal autocorrelation process for recruitment based on <code>drm_2</code>. Several variations are then built upon <code>drm_3</code>. Model <code>drm_4</code> introduces spatial movement dynamics and increased the number of age classes to six. In contrast, <code>drm_5</code> also increases the age classes to six but does not include movement. Model <code>drm_6</code> adds age-specific fishing mortality rates for 16 distinct age classes at each time point. Another variant, <code>drm_7</code>, modifies the <code>drm_3</code> structure: it retains the same formulation for the probability of absence but models recruitment with an AR(1) process that is constant across patches, and makes survival dependent on SBT.</p>
<p>Finally, for comparison, to a different class of model, <code>sdm</code>, was fitted. This was specified as a zero-augmented Gamma SDM where the absence probability component followed the structure used in <code>drm_3</code>, and the conditional density (for positive observations) was modeled as a quadratic function of SST.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">drm_2</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/fit_drm.html">fit_drm</a></span><span class="op">(</span>.data <span class="op">=</span> <span class="va">dat_train</span>,</span>
<span>          y_col <span class="op">=</span> <span class="st">"dens"</span>, <span class="co">## response variable: density</span></span>
<span>          time_col <span class="op">=</span> <span class="st">"year"</span>, <span class="co">## vector of time points</span></span>
<span>          site_col <span class="op">=</span> <span class="st">"patch"</span>,</span>
<span>          seed <span class="op">=</span> <span class="fl">202505</span>,</span>
<span>          formula_zero <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">c_hauls</span> <span class="op">+</span> <span class="va">c_btemp</span> <span class="op">+</span> <span class="va">c_stemp</span>,</span>
<span>          formula_rec <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">c_stemp</span> <span class="op">+</span> <span class="va">c_stemp</span> <span class="op">*</span> <span class="va">c_stemp</span>,</span>
<span>          formula_surv <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>          m <span class="op">=</span> <span class="fl">0</span>,</span>
<span>          .toggles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>est_surv <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>          init <span class="op">=</span> <span class="st">"pathfinder"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">drm_2</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/fit_drm.html">fit_drm</a></span><span class="op">(</span>.data <span class="op">=</span> <span class="va">dat_train</span>,</span>
<span>          y_col <span class="op">=</span> <span class="st">"dens"</span>, <span class="co">## response variable: density</span></span>
<span>          time_col <span class="op">=</span> <span class="st">"year"</span>, <span class="co">## vector of time points</span></span>
<span>          site_col <span class="op">=</span> <span class="st">"patch"</span>,</span>
<span>          seed <span class="op">=</span> <span class="fl">202505</span>,</span>
<span>          formula_zero <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">c_hauls</span> <span class="op">+</span> <span class="va">c_btemp</span> <span class="op">+</span> <span class="va">c_stemp</span>,</span>
<span>          formula_rec <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">c_stemp</span> <span class="op">+</span> <span class="va">c_stemp</span> <span class="op">*</span> <span class="va">c_stemp</span>,</span>
<span>          formula_surv <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>          m <span class="op">=</span> <span class="fl">0</span>,</span>
<span>          .toggles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>est_surv <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>          init <span class="op">=</span> <span class="st">"pathfinder"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">drm_3</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/fit_drm.html">fit_drm</a></span><span class="op">(</span>.data <span class="op">=</span> <span class="va">dat_train</span>,</span>
<span>          y_col <span class="op">=</span> <span class="st">"dens"</span>, <span class="co">## response variable: density</span></span>
<span>          time_col <span class="op">=</span> <span class="st">"year"</span>, <span class="co">## vector of time points</span></span>
<span>          site_col <span class="op">=</span> <span class="st">"patch"</span>,</span>
<span>          seed <span class="op">=</span> <span class="fl">202505</span>,</span>
<span>          formula_zero <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">c_hauls</span> <span class="op">+</span> <span class="va">c_btemp</span> <span class="op">+</span> <span class="va">c_stemp</span>,</span>
<span>          formula_rec <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">c_stemp</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">c_stemp</span> <span class="op">*</span> <span class="va">c_stemp</span><span class="op">)</span>,</span>
<span>          formula_surv <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>          .toggles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>est_surv <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                          time_ar <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>          init <span class="op">=</span> <span class="st">"pathfinder"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">adj_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gen_adj.html">gen_adj</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_unary.html" class="external-link">st_buffer</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">polygons</span><span class="op">)</span>,</span>
<span>                             dist <span class="op">=</span> <span class="fl">2500</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## row-standardized matrix</span></span>
<span><span class="va">adj_mat</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">adj_mat</span>, <span class="fl">1</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span> <span class="op">/</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">drm_4</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/fit_drm.html">fit_drm</a></span><span class="op">(</span>.data <span class="op">=</span> <span class="va">dat_train</span>,</span>
<span>          y_col <span class="op">=</span> <span class="st">"dens"</span>, <span class="co">## response variable: density</span></span>
<span>          time_col <span class="op">=</span> <span class="st">"year"</span>, <span class="co">## vector of time points</span></span>
<span>          site_col <span class="op">=</span> <span class="st">"patch"</span>,</span>
<span>          family <span class="op">=</span> <span class="st">"gamma"</span>,</span>
<span>          seed <span class="op">=</span> <span class="fl">202505</span>,</span>
<span>          formula_zero <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">c_hauls</span> <span class="op">+</span> <span class="va">c_btemp</span> <span class="op">+</span> <span class="va">c_stemp</span>,</span>
<span>          formula_rec <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">c_stemp</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">c_stemp</span> <span class="op">*</span> <span class="va">c_stemp</span><span class="op">)</span>,</span>
<span>          formula_surv <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>          n_ages <span class="op">=</span> <span class="fl">6</span>,</span>
<span>          adj_mat <span class="op">=</span> <span class="va">adj_mat</span>, <span class="co">## A matrix for movement routine</span></span>
<span>          ages_movement <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>, <span class="co">## ages allowed to move</span></span>
<span>          .toggles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>est_surv <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                          time_ar <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                          movement <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>          init <span class="op">=</span> <span class="st">"pathfinder"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">drm_5</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/fit_drm.html">fit_drm</a></span><span class="op">(</span>.data <span class="op">=</span> <span class="va">dat_train</span>,</span>
<span>          y_col <span class="op">=</span> <span class="st">"dens"</span>, <span class="co">## response variable: density</span></span>
<span>          time_col <span class="op">=</span> <span class="st">"year"</span>, <span class="co">## vector of time points</span></span>
<span>          site_col <span class="op">=</span> <span class="st">"patch"</span>,</span>
<span>          family <span class="op">=</span> <span class="st">"gamma"</span>,</span>
<span>          seed <span class="op">=</span> <span class="fl">202505</span>,</span>
<span>          formula_zero <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">c_hauls</span> <span class="op">+</span> <span class="va">c_btemp</span> <span class="op">+</span> <span class="va">c_stemp</span>,</span>
<span>          formula_rec <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">c_stemp</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">c_stemp</span> <span class="op">*</span> <span class="va">c_stemp</span><span class="op">)</span>,</span>
<span>          formula_surv <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>          n_ages <span class="op">=</span> <span class="fl">6</span>,</span>
<span>          .toggles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>est_surv <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                          time_ar <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>          init <span class="op">=</span> <span class="st">"pathfinder"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## instantaneous fishing mortality rates</span></span>
<span><span class="va">fmat</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"fmat.rds"</span>, package <span class="op">=</span> <span class="st">"drmr"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">f_train</span> <span class="op">&lt;-</span> <span class="va">fmat</span><span class="op">[</span>, <span class="va">years_train</span><span class="op">]</span></span>
<span><span class="va">f_test</span>  <span class="op">&lt;-</span> <span class="va">fmat</span><span class="op">[</span>, <span class="va">years_test</span><span class="op">]</span></span>
<span></span>
<span><span class="va">drm_6</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/fit_drm.html">fit_drm</a></span><span class="op">(</span>.data <span class="op">=</span> <span class="va">dat_train</span>,</span>
<span>          y_col <span class="op">=</span> <span class="st">"dens"</span>, <span class="co">## response variable: density</span></span>
<span>          time_col <span class="op">=</span> <span class="st">"year"</span>, <span class="co">## vector of time points</span></span>
<span>          site_col <span class="op">=</span> <span class="st">"patch"</span>,</span>
<span>          family <span class="op">=</span> <span class="st">"gamma"</span>,</span>
<span>          seed <span class="op">=</span> <span class="fl">202505</span>,</span>
<span>          formula_zero <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">c_hauls</span> <span class="op">+</span> <span class="va">c_btemp</span> <span class="op">+</span> <span class="va">c_stemp</span>,</span>
<span>          formula_rec <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">c_stemp</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">c_stemp</span> <span class="op">*</span> <span class="va">c_stemp</span><span class="op">)</span>,</span>
<span>          formula_surv <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>          n_ages <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">NROW</a></span><span class="op">(</span><span class="va">f_train</span><span class="op">)</span>,</span>
<span>          f_mort <span class="op">=</span> <span class="va">f_train</span>,</span>
<span>          .toggles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>time_ar <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                          est_surv <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>          init <span class="op">=</span> <span class="st">"pathfinder"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">drm_7</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/fit_drm.html">fit_drm</a></span><span class="op">(</span>.data <span class="op">=</span> <span class="va">dat_train</span>,</span>
<span>          y_col <span class="op">=</span> <span class="st">"dens"</span>, <span class="co">## response variable: density</span></span>
<span>          time_col <span class="op">=</span> <span class="st">"year"</span>, <span class="co">## vector of time points</span></span>
<span>          site_col <span class="op">=</span> <span class="st">"patch"</span>,</span>
<span>          family <span class="op">=</span> <span class="st">"gamma"</span>,</span>
<span>          seed <span class="op">=</span> <span class="fl">202505</span>,</span>
<span>          formula_zero <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">c_hauls</span> <span class="op">+</span> <span class="va">c_btemp</span> <span class="op">+</span> <span class="va">c_stemp</span>,</span>
<span>          formula_rec <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>          formula_surv <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">c_btemp</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">c_btemp</span> <span class="op">*</span> <span class="va">c_btemp</span><span class="op">)</span>,</span>
<span>          .toggles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>time_ar <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                          est_surv <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>          init <span class="op">=</span> <span class="st">"pathfinder"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sdm</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/fit_sdm.html">fit_sdm</a></span><span class="op">(</span>.data <span class="op">=</span> <span class="va">dat_train</span>,</span>
<span>          y_col <span class="op">=</span> <span class="st">"dens"</span>, <span class="co">## response variable: density</span></span>
<span>          time_col <span class="op">=</span> <span class="st">"year"</span>, <span class="co">## vector of time points</span></span>
<span>          site_col <span class="op">=</span> <span class="st">"patch"</span>,</span>
<span>          seed <span class="op">=</span> <span class="fl">202505</span>,</span>
<span>          formula_zero <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">c_hauls</span> <span class="op">+</span> <span class="va">c_btemp</span> <span class="op">+</span> <span class="va">c_stemp</span>,</span>
<span>          formula_dens <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">c_stemp</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">c_stemp</span> <span class="op">*</span> <span class="va">c_stemp</span><span class="op">)</span>,</span>
<span>          .toggles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>time_ar <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>          init <span class="op">=</span> <span class="st">"pathfinder"</span><span class="op">)</span></span></code></pre></div>
</div>
<p>To compare models goodness-of-fit we use the <code>loo</code> package, which implements the Leave-One-Out Information Criterion <span class="citation" data-cites="vehtari2017practical">(LOOIC, <a href="#ref-vehtari2017practical" role="doc-biblioref">Vehtari, Gelman, and Gabry 2017</a>)</span>. First, we create a list with the LOOIC for each model, and then compare them using the <code>loo_compare</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">loos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"baseline"</span> <span class="op">=</span> <span class="va">baseline</span><span class="op">$</span><span class="va">stanfit</span><span class="op">$</span><span class="fu">loo</span><span class="op">(</span><span class="op">)</span>,</span>
<span>             <span class="st">"drm_1"</span> <span class="op">=</span> <span class="va">drm_1</span><span class="op">$</span><span class="va">stanfit</span><span class="op">$</span><span class="fu">loo</span><span class="op">(</span><span class="op">)</span>,</span>
<span>             <span class="st">"drm_2"</span> <span class="op">=</span> <span class="va">drm_2</span><span class="op">$</span><span class="va">stanfit</span><span class="op">$</span><span class="fu">loo</span><span class="op">(</span><span class="op">)</span>,</span>
<span>             <span class="st">"drm_3"</span> <span class="op">=</span> <span class="va">drm_3</span><span class="op">$</span><span class="va">stanfit</span><span class="op">$</span><span class="fu">loo</span><span class="op">(</span><span class="op">)</span>,</span>
<span>             <span class="st">"drm_4"</span> <span class="op">=</span> <span class="va">drm_4</span><span class="op">$</span><span class="va">stanfit</span><span class="op">$</span><span class="fu">loo</span><span class="op">(</span><span class="op">)</span>,</span>
<span>             <span class="st">"drm_5"</span> <span class="op">=</span> <span class="va">drm_5</span><span class="op">$</span><span class="va">stanfit</span><span class="op">$</span><span class="fu">loo</span><span class="op">(</span><span class="op">)</span>,</span>
<span>             <span class="st">"drm_6"</span> <span class="op">=</span> <span class="va">drm_6</span><span class="op">$</span><span class="va">stanfit</span><span class="op">$</span><span class="fu">loo</span><span class="op">(</span><span class="op">)</span>,</span>
<span>             <span class="st">"drm_7"</span> <span class="op">=</span> <span class="va">drm_7</span><span class="op">$</span><span class="va">stanfit</span><span class="op">$</span><span class="fu">loo</span><span class="op">(</span><span class="op">)</span>,</span>
<span>             <span class="st">"sdm"</span>   <span class="op">=</span> <span class="va">sdm</span><span class="op">$</span><span class="va">stanfit</span><span class="op">$</span><span class="fu">loo</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">loos_out</span> <span class="op">&lt;-</span> <span class="fu">loo</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/loo/reference/loo_compare.html" class="external-link">loo_compare</a></span><span class="op">(</span><span class="va">loos</span><span class="op">)</span></span></code></pre></div>
</div>
<p>The <code>loo_compare</code> outputs a table with the difference between the LOOIC from the best model (in terms of LOOIC as a goodness-of-fit metric) to each of the models and orders those differences from “best” to “worst” fit.</p>
<p>The model with the best goodness-of-fit does not necessarily delivers the best predictions (or forecasts). The forecasts for each model are easily computed through the <code>predict_drm</code> (or <code>predict_sdm</code>, if applied to the output of <code>fit_sdm</code>) function. See below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">forecast_0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_drm.html">predict_drm</a></span><span class="op">(</span>drm <span class="op">=</span> <span class="va">baseline</span>,</span>
<span>                          new_data <span class="op">=</span> <span class="va">dat_test</span>,</span>
<span>                          seed <span class="op">=</span> <span class="fl">125</span>,</span>
<span>                          cores <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="va">forecast_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_drm.html">predict_drm</a></span><span class="op">(</span>drm <span class="op">=</span> <span class="va">drm_1</span>,</span>
<span>                          new_data <span class="op">=</span> <span class="va">dat_test</span>,</span>
<span>                          seed <span class="op">=</span> <span class="fl">125</span>,</span>
<span>                          cores <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="va">forecast_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_drm.html">predict_drm</a></span><span class="op">(</span>drm <span class="op">=</span> <span class="va">drm_2</span>,</span>
<span>                          new_data <span class="op">=</span> <span class="va">dat_test</span>,</span>
<span>                          past_data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dat_train</span>,</span>
<span>                                             <span class="va">year</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                          seed <span class="op">=</span> <span class="fl">125</span>,</span>
<span>                          cores <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="va">forecast_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_drm.html">predict_drm</a></span><span class="op">(</span>drm <span class="op">=</span> <span class="va">drm_3</span>,</span>
<span>                          new_data <span class="op">=</span> <span class="va">dat_test</span>,</span>
<span>                          past_data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dat_train</span>,</span>
<span>                                             <span class="va">year</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                          seed <span class="op">=</span> <span class="fl">125</span>,</span>
<span>                          cores <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="va">forecast_4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_drm.html">predict_drm</a></span><span class="op">(</span>drm <span class="op">=</span> <span class="va">drm_4</span>,</span>
<span>                          new_data <span class="op">=</span> <span class="va">dat_test</span>,</span>
<span>                          past_data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dat_train</span>,</span>
<span>                                             <span class="va">year</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                          seed <span class="op">=</span> <span class="fl">125</span>,</span>
<span>                          cores <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="va">forecast_5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_drm.html">predict_drm</a></span><span class="op">(</span>drm <span class="op">=</span> <span class="va">drm_5</span>,</span>
<span>                          new_data <span class="op">=</span> <span class="va">dat_test</span>,</span>
<span>                          past_data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dat_train</span>,</span>
<span>                                             <span class="va">year</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                          seed <span class="op">=</span> <span class="fl">125</span>,</span>
<span>                          cores <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="va">forecast_6</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_drm.html">predict_drm</a></span><span class="op">(</span>drm <span class="op">=</span> <span class="va">drm_6</span>,</span>
<span>                          new_data <span class="op">=</span> <span class="va">dat_test</span>,</span>
<span>                          past_data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dat_train</span>,</span>
<span>                                             <span class="va">year</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                          f_test <span class="op">=</span> <span class="va">f_test</span>,</span>
<span>                          seed <span class="op">=</span> <span class="fl">125</span>,</span>
<span>                          cores <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="va">forecast_7</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_drm.html">predict_drm</a></span><span class="op">(</span>drm <span class="op">=</span> <span class="va">drm_7</span>,</span>
<span>                          new_data <span class="op">=</span> <span class="va">dat_test</span>,</span>
<span>                          past_data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dat_train</span>,</span>
<span>                                             <span class="va">year</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                          seed <span class="op">=</span> <span class="fl">125</span>,</span>
<span>                          cores <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="va">forecast_sdm</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/predict_sdm.html">predict_sdm</a></span><span class="op">(</span>sdm <span class="op">=</span> <span class="va">sdm</span>,</span>
<span>              new_data <span class="op">=</span> <span class="va">dat_test</span>,</span>
<span>              seed <span class="op">=</span> <span class="fl">125</span>,</span>
<span>              cores <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="co">##--- summarizing forecasts ----</span></span>
<span></span>
<span><span class="va">all_forecasts</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"^forecast_"</span><span class="op">)</span></span>
<span><span class="va">all_drms</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"^(baseline|drm_|sdm)"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">forecasts_summary</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Map</a></span><span class="op">(</span>f <span class="op">=</span> \<span class="op">(</span><span class="va">x</span>, <span class="va">nm</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">fct</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/get.html" class="external-link">get</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>    <span class="va">fct</span><span class="op">$</span><span class="fu">draws</span><span class="op">(</span>variables <span class="op">=</span> <span class="st">"y_proj"</span>,</span>
<span>              format <span class="op">=</span> <span class="st">"draws_df"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"y_proj"</span><span class="op">)</span>,</span>
<span>                          names_to <span class="op">=</span> <span class="st">"pair"</span>,</span>
<span>                          values_to <span class="op">=</span> <span class="st">"expected"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">pair</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>ll <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">expected</span>, probs <span class="op">=</span> <span class="fl">.05</span><span class="op">)</span>,</span>
<span>                l <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">expected</span>, probs <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span>,</span>
<span>                m <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">expected</span><span class="op">)</span>,</span>
<span>                u <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">expected</span>, probs <span class="op">=</span> <span class="fl">.9</span><span class="op">)</span>,</span>
<span>                uu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">expected</span>, probs <span class="op">=</span> <span class="fl">.95</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>pair <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"\\D"</span>, <span class="st">""</span>, <span class="va">pair</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>pair <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">pair</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">pair</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">nm</span>,</span>
<span>             .before <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">}</span>, x <span class="op">=</span> <span class="va">all_forecasts</span>, nm <span class="op">=</span> <span class="va">all_drms</span><span class="op">)</span></span>
<span></span>
<span><span class="va">forecasts_summary</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">forecasts_summary</span><span class="op">)</span></span>
<span></span>
<span><span class="va">forecasts_summary</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">dat_test</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">dens</span>, <span class="va">lat_floor</span>, <span class="va">patch</span>, <span class="va">year</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>pair <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/row_number.html" class="external-link">row_number</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">forecasts_summary</span>, by <span class="op">=</span> <span class="st">"pair"</span><span class="op">)</span></span></code></pre></div>
</div>
<p>Now, we display the comparisons of Goodness-of-fit and predictive skill. In that table, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Δ</mi><annotation encoding="application/x-tex">\Delta</annotation></semantics></math>-LOOIC represents the difference between the LOOIC and the model with the best fit; RMSE is the root mean square error of prediction; IS is the interval score; PIC is the frequentist coverage of the 80% prediction intervals; and Time is the time (in seconds) to fit the models.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">forecasts_summary</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>bias <span class="op">=</span> <span class="va">dens</span> <span class="op">-</span> <span class="va">m</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>rmse <span class="op">=</span> <span class="va">bias</span> <span class="op">*</span> <span class="va">bias</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>is <span class="op">=</span> <span class="fu"><a href="../reference/int_score.html">int_score</a></span><span class="op">(</span><span class="va">dens</span>, l <span class="op">=</span> <span class="va">l</span>, u <span class="op">=</span> <span class="va">u</span>, alpha <span class="op">=</span> <span class="fl">.2</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>cvg <span class="op">=</span> <span class="fl">100</span> <span class="op">*</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/between.html" class="external-link">between</a></span><span class="op">(</span><span class="va">dens</span>, <span class="va">l</span>, <span class="va">u</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="va">rmse</span><span class="op">:</span><span class="va">cvg</span>, <span class="va">mean</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select_all.html" class="external-link">rename_all</a></span><span class="op">(</span><span class="va">toupper</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span><span class="st">"Model"</span> <span class="op">=</span> <span class="st">"MODEL"</span>,</span>
<span>         <span class="st">"IS (80%)"</span> <span class="op">=</span> <span class="st">"IS"</span>,</span>
<span>         <span class="st">"PIC (80%)"</span> <span class="op">=</span> <span class="st">"CVG"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">aux_qt</span>,</span>
<span>            by <span class="op">=</span> <span class="st">"Model"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">LOOIC</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html" class="external-link">relocate</a></span><span class="op">(</span><span class="va">LOOIC</span>, .after <span class="op">=</span> <span class="st">"Model"</span><span class="op">)</span></span></code></pre></div>
</div>
<table class="table caption-top">
<colgroup>
<col style="width: 17%">
<col style="width: 23%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Model</th>
<th style="text-align: right;">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Δ</mi><annotation encoding="application/x-tex">\Delta</annotation></semantics></math>-LOOIC</th>
<th style="text-align: right;">RMSE</th>
<th style="text-align: right;">IS</th>
<th style="text-align: right;">PIC</th>
<th style="text-align: right;">Time</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>drm_3</code></td>
<td style="text-align: right;"><strong>0.00</strong></td>
<td style="text-align: right;">8.98</td>
<td style="text-align: right;"><strong>8.60</strong></td>
<td style="text-align: right;"><strong>78.0</strong></td>
<td style="text-align: right;">13.34</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>sdm</code></td>
<td style="text-align: right;">-6.07</td>
<td style="text-align: right;">12.04</td>
<td style="text-align: right;">12.72</td>
<td style="text-align: right;">60.0</td>
<td style="text-align: right;">3.88</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>drm_4</code></td>
<td style="text-align: right;">-7.35</td>
<td style="text-align: right;">8.30</td>
<td style="text-align: right;">8.87</td>
<td style="text-align: right;">84.0</td>
<td style="text-align: right;">28.70</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>drm_5</code></td>
<td style="text-align: right;">-7.74</td>
<td style="text-align: right;"><strong>8.23</strong></td>
<td style="text-align: right;">8.96</td>
<td style="text-align: right;">86.0</td>
<td style="text-align: right;">19.24</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>drm_7</code></td>
<td style="text-align: right;">-10.41</td>
<td style="text-align: right;">8.75</td>
<td style="text-align: right;">8.97</td>
<td style="text-align: right;">78.0</td>
<td style="text-align: right;">22.73</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>drm_6</code></td>
<td style="text-align: right;">-18.04</td>
<td style="text-align: right;">10.22</td>
<td style="text-align: right;">10.49</td>
<td style="text-align: right;">86.0</td>
<td style="text-align: right;">33.73</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>drm_1</code></td>
<td style="text-align: right;">-22.49</td>
<td style="text-align: right;">11.17</td>
<td style="text-align: right;">10.68</td>
<td style="text-align: right;">68.0</td>
<td style="text-align: right;">4.67</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>drm_2</code></td>
<td style="text-align: right;">-32.32</td>
<td style="text-align: right;">10.73</td>
<td style="text-align: right;">10.29</td>
<td style="text-align: right;">68.0</td>
<td style="text-align: right;">4.44</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>baseline</code></td>
<td style="text-align: right;">-163.85</td>
<td style="text-align: right;">14.44</td>
<td style="text-align: right;">12.98</td>
<td style="text-align: right;">74.0</td>
<td style="text-align: right;"><strong>1.35</strong></td>
</tr>
</tbody>
</table>
<p>Despite having the second-best model fit based on LOOIC, the SDM yielded the second-worst predictive performance according to RMSE and IS. This suggests the DRM’s mechanistic formulation enhances forecasting ability, potentially outweighing a slightly less optimal fit statistic. This is understandable, as DRMs incorporate biologically-informed constraints that can improve predictions.</p>
</section><section class="level2"><h2 id="coming-soon">Coming soon<a class="anchor" aria-label="anchor" href="#coming-soon"></a>
</h2>
<p>We are working on the following additional vignettes:</p>
<ul>
<li><p>priors used in our models and how to modify them</p></li>
<li><p>toggles and their specific options</p></li>
<li><p>Initialization of the population dynamics</p></li>
</ul></section><section class="level2 unnumbered"><h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-fredston2025dynamic" class="csl-entry" role="listitem">
Fredston, Alexa, Daniel Ovando, Lucas da Cunha Godoy, Jude Kong, Brandon Muffley, James T Thorson, and Malin Pinsky. 2025. <span>“Dynamic Range Models Improve the Near-Term Forecast for a Marine Species on the Move.”</span> <em>Ecology Letters</em> 00: (under review). <a href="https://doi.org/10.32942/X24D00" class="external-link">https://doi.org/10.32942/X24D00</a>.
</div>
<div id="ref-gabry2024cmdstanr" class="csl-entry" role="listitem">
Gabry, Jonah, Rok Çešnovar, Andrew Johnson, and Steve Bronder. 2024. <em>Cmdstanr: R Interface to <span>CmdStan</span></em>. <a href="https://github.com/stan-dev/cmdstanr" class="external-link">https://github.com/stan-dev/cmdstanr</a>.
</div>
<div id="ref-landau2024instantiate" class="csl-entry" role="listitem">
Landau, William Michael. 2024. <em>Instantiate: Pre-Compiled <span>CmdStan</span> Models in <span>R</span> Packages</em>. <a href="https://CRAN.R-project.org/package=instantiate" class="external-link">https://CRAN.R-project.org/package=instantiate</a>.
</div>
<div id="ref-vehtari2017practical" class="csl-entry" role="listitem">
Vehtari, Aki, Andrew Gelman, and Jonah Gabry. 2017. <span>“Practical Bayesian Model Evaluation Using Leave-One-Out Cross-Validation and WAIC.”</span> <em>Statistics and Computing</em> 27: 1413–32.
</div>
<div id="ref-zhang2022pathfinder" class="csl-entry" role="listitem">
Zhang, Lu, Bob Carpenter, Andrew Gelman, and Aki Vehtari. 2022. <span>“Pathfinder: Parallel Quasi-Newton Variational Inference.”</span> <em>Journal of Machine Learning Research</em> 23 (306): 1–49. <a href="http://jmlr.org/papers/v23/21-0889.html" class="external-link">http://jmlr.org/papers/v23/21-0889.html</a>.
</div>
</div>
</section><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config);
    }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script></main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Lucas da Cunha Godoy.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
